\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Ana-Çift Ýç Nokta Metotlarý (Primal-Dual Interior-Point Methods)

Þimdiye kadar gördüðümüz problem tiplerini hatýrlayalým þimdi ve çözme
zorluðu açýsýndan sýralayalým. En üstte, en basit olan karesel
problemlerdi, 

$$
\min_x \frac{1}{2}  x^T Q x + c^T x
$$

formunda oluyorlardý. Bu problemler en basiti, eðer $Q$ pozitif yarý-kesin
ise. Basit çünkü gradyani alýp sýfýra eþitliyorum, pat diye sonucu
buluyorum. 

Sonraki seviye, biraz daha zor, üstteki probleme $Ax=b$ formunda eþitlik
kýsýtlamasý getirmek. Bu problemi de kapalý / analitik halde (closed-form)
çözebiliriz, KKT koþullarýný kullanarak. $Ax=b$ ifadesini ek deðiþkenler
üzerinden kritere ekleriz, Lagrangian'ý oluþtururuz, KKT koþulunda iki tane
öðe olur, duraðanlýk, ve ana olurluk, bu iki öðeyi eþzamanlý olarak çözerek
sonuca ulaþýrýz, koca bir lineer sistemdir bu. 

Bir sonraki pürüzsüz minimizasyon, yani üstteki kriterin yerine $f(x)$
kullanmak ki $f(x)$ bir pürüzsüz fonksiyon. Bu durumda Newton metotu
kullanýyoruz, bu metot $Ax=b$ kýsýtlamasýnda $f(x)$ minimizasyonunu birkaç
adýmda çözmeye uðraþýyor, bunu her adýmda $f(x)$'e bir karesel yaklaþýklama
yaparak baþarýyor. 

Sonraki seviye ise iç nokta metotlarý, eþitlik kýsýtlamalarýna ek olarak
$h_i(x) \le 0, i=1,..,m$ formunda eþitsizlik kýsýtlamalarý eklemek.  Bu
derste bu tür problemleri ana-çift yöntemi ile çözeceðiz, daha önceki bir
derste bariyer yöntemi iç nokta metotu ile çözdük. 

Genel olarak yaptýðýmýz herhangi bir seviyedeki problemi çözmeye
uðraþtýðýmýzda onu bir önce seviyedeki probleme indirgemek, problemi belli
adýmlara bölerek her adýmda nasýl iþlediðini bildiðimiz önceki seviyedeki
tekniði uygulamak. Bariyer metotunda öyle oldu mesela, eþitsizlik
problemini bariyer terimini kritere ekleyerek bilinen Newton adýmlarýyla
onu çözmeye uðraþtýk. 

Ana-çift metotu biraz daha farklý olacak. Onu öðrendiðimizde göreceksiniz
ki bir problemi açýk bir þekilde baþka bir probleme indirgemediðini
göreceksiniz [1, 5:55]. Bu tekniði sarsýma puðratýlmýþ KKT koþullarý
ýþýðýnda ele almak lazým, ana prensibi bu. 

[bariyer metot ozeti atlandi]

Ana-çift metotu, bariyer metodundan farklý olarak, $t$ parametresinin
güncellemeden önce sadece tek Newton adýmý atar. Yani ana-çift metotunda da
yaklaþýksallamanýn kuvvetini kontrol eden bir $t$ var, ama o belli bir $t$
üzerinden yakýnsama oluncaya kadar Newton adýmý atmak yerine her $t$ için
tek Newton adýmý atýlýyor. Bu demektir ki dýþ döngü, iç döngü farký yok,
her þey tek bir döngü içinde.

Bir diðer fark ana-çift döngüsünde giderken üretilen (ziyaret edilen)
noktalar illa olurlu olmayabiliyor. Yapýsý itibariyle metot döngüsü
sýrasýnda eþitsizlik kýsýtlamalarýný tatmin eder, fakat her zaman eþitlik
kýsýtlamalarýný tatmin etmeyebilir. Hatta bazen ikiz olurlu noktalar bile
mevcut olmayabilir, bu daha ciddi bir durum. Hatýrlarsak bariyer metotunda
ikiz olurlu nokta her zaman vardý ve bu noktayý bir ikiz boþluðu hesaplamak
için kullanabiliyorduk. Bu boþluðu hesaplamak kolaydý, her noktada
$m / t < \epsilon$ deðerindeydi.

O zaman ana-çift ile bu hesap yoksa, ne zaman duracaðýmýzý tam bilmiyoruz
demektir, demek ki akýllýca uydurma (heuristic) yaparak bir durma þartý
bulmamýz lazým.

Pozitif baðlamda ana-çift metotlarý daha verimli çalýþýr. Ýspatýna
girmeyeceðiz ama ana-çift yakýnsamasý lineerden daha iyidir.

Negatif olarak ana-çift metotlarýný kabaca, sezgisel kavramak bariyer
metotu kadar direk olmayabilir. Þahsen bu alanda araþtýrmacý olan ben bile
ana-çift metot adýmlarýnýn temelii hatýrlamakta bazen zorlanýyorum, bariyer
metotunu hatýrlamak basit, kýsýtlamanýn log'unu alýp kritere ekliyorsunuz,
sonra Newton metotu uyguluyorsunuz [13:35].

Detaylara gelelim. KKT koþul sarsýmýný hatýrlarsak, bariyer metotunu KKT
koþullarinda bir sarsým olarak görebiliyorduk, þu ifadelerde

$$
\nabla f(x) + \sum_{i=1}^{m} u_i\nabla h_i + A^T v = 0
\mlabel{1}
$$

$$
u_i \cdot h_i(x) = (-1/t) 1, \quad i=1,..,m
$$

$$
h_i(x) \le 0, \quad i=1,..,m, \quad Ax = b
$$

$$
u_i \ge 0
$$

Bloktaki ikinci ifade yerine 

$$
u_i \cdot h_i(x) = 0, \quad i=1,..,m
\mlabel{2}
$$

kullanýyoruz. Deðisen tamamlayýcý gevþeklik yani.

Ana problem neydi?

$$
\min_x f(x) \quad \textrm{öyle ki}
$$
$$
Ax = b
$$
$$
h_i(x) \le 0, \quad i=1,..,m
$$

Bu problemin KKT þartlarý görülen blokta, duraðanlýk için gradyan alýp
sýfýra eþitlenir, (1)'i elde edilir, tabii $f,h_i$'in pürüzsüz ve dýþbükey
olduðu farz edilir, o sebeple gradyan yeterli, altgradyana gerek yok, vs.
Tek deðiþtirdiðimiz tamamlayýcý gevþeklik ve onun artýk sýfýra eþit
olmasýný þart koþmuyorum, ufak baþka bir deðere, ve doðru iþarete sahip
olan baþka bir deðere eþit olmasýný zorluyorum, $u_i \cdot h_i(x) = (-1/t)$
þartý bu. $1/t$ gibi bir deðerin sebebi aslýnda $\log(x)$'in türevinin
$1/\log(x)$ olmasýyla alakalý, çünkü log bariyerleþtirilmiþ kriterin
türevini alýp sýfýra eþitleyince ve ikiz deðiþkenleri uygun þekilde
tanýmlayýnca log bariyer metotunun orijinal KKT koþullarý yerine üstteki
þekilde bir problemi çözülebildiðini görmüþtük [1, 16:19], ve $t$
büyütüldükçe görülen deðiþtirilmiþ tamamlayýcý gevþeklik esas versiyonuna
daha da yaklaþýyordu.

[bariyer KKT matris versiyonu atlandý]

Ana-çift metotlarýna eriþmenin bir diðer yolu sarsýmýn ortaya çýkarttýðý
denklemleri birarada çözmek ve Newton adýmýný ona göre atmak [1, 22:55]. 
Sarsým denklem sistemini sýfýra eþitlemek amacýyla matris formunda
düzenlersek, 

$$
r(x,u,v) = 
\left[\begin{array}{c}
\nabla f(x) + Dh(x)^T u + A^T v \\
-\diag(u)h(x) - 1/t \\
Ax - b
\end{array}\right]
\mlabel{3}
$$

ki

$$
h(x) = \left[\begin{array}{c}
h_1(x) \\
\dots \\
h_m(x)
\end{array}\right]
\quad
D h(x) = \left[\begin{array}{c}
D h_1(x)^T \\
\dots \\
D h_m(x)^T
\end{array}\right]
\mlabel{4}
$$

$r(x,u,v)$'yu sýfýra eþitliyoruz, yani bir anlamda 

$$
0 = r (x+\Delta x, u + \Delta u, v + \Delta v)
$$

çözülecek, bunu 1. derece Taylor açýlýmý ile yaklaþýklarým,

$$
\approx r(x,u,v) + D r(x,u,v) \left[\begin{array}{c}
\Delta x \\ \Delta u \\ \Delta v
\end{array}\right]
$$

Üstteki denklemde (3,4) öðelerini kullanarak özyineli þekilde dönersem
gayri-lineer denklemi çözmüþ olurum. Notasyonu biraz degistirirsek, $y =
(x,u,v)$ ile, 

$$
0 = r(y + \Delta y) \approx r(y) + D r(y) \Delta y
$$

ve $\Delta y$ için çözmek istiyoruz. 

Ya da, genel bir $F$ için $F(y) = 0$ çözümü, yani ``kök bulmak'' amacýyla
her döngü adýmýnda bir $\Delta y$ hesaplayabilmek istiyoruz. Þu þekilde

$$
F(y + \Delta y) \approx F(y) + D F(y) \Delta y
$$

yaklaþýklarsak, ve kök amaçlý $F(y)=0$ olmalý ama $F(y + \Delta y) = 0$ da
denebilir,

$$
0 \approx F(y) + D F(y) \Delta y
$$

$$
-F(y) =  D F(y) \Delta y
$$

$$
\Delta y = -(DF(y))^{-1} F(y) 
$$

Ya da

$$
DF(y) \Delta y = -F(y) 
$$

Bu problemde $F$ yerine $r$ var. 

$$
D r(y) \Delta y = -r(y) 
$$

O zaman (3)'teki $r(y)$'nin türevi, yani Jacobian'ý gerekiyor. Üsttekini
þöyle yazýyoruz, 

$$
\left[\begin{array}{ccc}
\nabla^2 f(x) + \sum _{i=1}^{m} u_i \nabla^2 h_i(x) & D h(x)^T & A^T \\
-\diag(u) D h(x) & -\diag(h(x)) & 0 \\
A & 0 & 0
\end{array}\right]
\left[\begin{array}{c}
\Delta x \\ \Delta y \\ \Delta v
\end{array}\right] = 
\left[\begin{array}{c}
r_1 \\ r_2 \\ r_3 
\end{array}\right] 
$$

Buyuk Jacobian'i nasil elde ettik? Mesela (3)'un ilk satirina bakalim, 

$$
\nabla f(x) + Dh(x)^T u + A^T v 
$$

var, onun $x,u,v$'ye göre türevlerini almak bize iki üstteki matrisin
1. satýr 1. 2. ve 3. kolonunu veriyor, mesela $x$'e göre türev alýnca bir
üstteki ifadede 1. ve 2. terimin türevi alýnýr, $A^T v $ yokolur, bu bize
$\nabla^2 f(x) + \sum _{i=1}^{m} u_i \nabla^2 h_i(x)$ verir [1, 28:43].
Ayný þekilde devam edersek görülen matrisi elde ederiz. Tüm sistemi
$\Delta y$ için çözünce de istediðimiz Newton yönünü elde ederiz.

Bu yönteme ana-çift denmesinin sebebi üstte görülüyor aslýnda, çünkü dikkat
edersek hem ana hem ikiz deðiþkenleri ayný sistemde, ayný anda
çözüyoruz. Deðil mi? Denklem sistemi KKT koþularýnýn formülize edilmesinden
geldi, ve bu koþullara ana ve ikiz deðiþkenler ayný yerde mevcuttur, ve
çözerken tüm $x,u,v$ için çözüyoruz. 

Not: Bu yaklaþýmla bariyer metotuna eriþmek mümkün, o durumda sistemden $u$
çýkartýlýr, ve geri kalanlar çözülür. 

Metotu algoritmik olarak görmeden önce bir konudan daha bahsetmek istiyorum
- alternatif ikizlik boþluðu. Bu gerçek ikizlik boþluðu deðil, çünkü daha
önce belirttiðimiz gibi bu metotta ikiz deðiþkenler her zaman olurlu
olmayabiliyor. 

Bariyer metotu için ikizlik boþluðu basitti, $m/t$ çünkü
$u_i = -1 / (t h_i(x))$, $i=1,..,m$ tanýmlamýþtýk ve bu ikiz olurlu idi.
Alternatif boþluk için sanki ikiz olurluk varmýþ gibi yapýyoruz, ve 

$$
\eta = -h(x)^T u = - \sum _{i=1}^{m} u_i h_i(x)
$$

hesabýný yapýyoruz. Eðer üstteki hesabý bariyer problemi için yapýyor
olsaydýk, $u_i = -1/t$ tanýmlamýþ olacaktýk ve o zaman bariyer metotu için
olan boþluðu elde edecektik. Ana-çift yönteminde böyle deðil tabii, sistemi
çözerken $u_i$ için de çözüm yapýyoruz, onu önceden tanýmlamýyoruz, fakat
üstteki formu kullanarak alternatif ikizlik boþluðunu elde edebiliriz.  
$\eta$ her zaman pozitif olacak, çünkü kendimizi her zaman $h_i(x) \le 0$
olacak þekilde kýsýtlayacaðýz, ve $u_i \ge 0$ zaten, o zaman çarpýmlarýnýn
ekþi ile çarpýlmasý pozitif sonuç verir.

Tüm bunlarý durma þartý için nasýl kullanýrýz? Her ne kadar $u_i$'lar
olurlu olmayabilse bile yine de boþluðu hesaplýyoruz, ardýndan ikiz
deðiþkenlerin olurluða ne kadar yakýn olduðunu ayrý bir yerde
hesaplýyoruz. Yani eðer alternatif boþluk az, ve olurluða yakýnlýk varsa,
akýllýca bir uydurma ile kullanarak durma / durmama kararý verebiliriz. 









[devam edecek]

Kaynaklar

[1] Tibshirani, {\em Convex Optimization, Lecture Video 16}, 
\url{https://www.youtube.com/channel/UCIvaLZcfz3ikJ1cD-zMpIXg}   

\end{document}



