\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Log-Bariyer Yöntemi

[Newton yöntemi özeti atlandý]

Þimdiye kadar kýsýtlanmamýþ Newton yönteminden bahsettik [1, 53:18]. Þimdi
lineer olarak kýsýtlanmýþ, $Ax=b$ ile, olan duruma bakalým, çünkü ileride
faydalý olacak.

En bariz yaklaþým $Ax=b$'nin bir doðrusal (affine) uzay yaratmasý, ve
optimizasyonun bu daha ufak uzayda iþ yapmasý. Bir deðiþken deðiþimi
yaparýz, $x = Fy + x_0$, ki $F$, $A$'nin sýfýr uzayýný kapsýyor, ardýndan
optimizasyon problemini $y$ bazlý bir probleme indirge. Bu yaklaþýma
``indirgenmiþ uzay yaklaþýmý'' deniyor. Tarif edilen gayet doðal, basit bir
yaklaþým aslýnda, fakat bir bedeli de var. Eðer orijinal problem seyrek ise
deðiþim sonrasý çok miktarda yapý kaybý (yaý seyreklik) olacak.

Bir diðer seçenek eþitlikle kýsýtlanmýþ Newton (equality constrained
Newton). Bu yöntemle $x^+ = x + t v$ adýmýnda $v$ karesel
yaklaþýksallamanýn çözümü, fakat bu çözüm sýnýrlanmýþ bir problemin çözümü,
bir sonraki $x^+$'yi olurlu halde tutacak bir sýnýrlama bu.

Çözülen problem 

$$
v = \arg\min_{Az = 0} \nabla f(x)^T (z-x) + \frac{1}{2} (z-x)^T \nabla^2 f(x)(z-x)
$$

Üstteki $x^+$'i olurlu kümede tutar çünkü 

$$
Ax^+ = Ax + tAv = b + 0 = b
$$

KKT koþullarý üzerinden çözüm

$$
\left[\begin{array}{cc}
\nabla^2 f(x) & A^T \\
A & 0
\end{array}\right]
\left[\begin{array}{c}
v \\
w
\end{array}\right] = 
- 
\left[\begin{array}{c}
\nabla f(x) \\
Ax - b
\end{array}\right]
$$

ile belirtilebilir. KKT bölümünde karesel problem örneðindeki gördüðümüz
$Q$ burada $\nabla^2 f(x)$ oluyor, atýlan adým sonrasý gelinen yerin ne
olacaðý da kýsýtlama içinde görülebilir.

Olurlu noktadan basliyorsak, ozel durum $Ax = b$, tabii o zaman 

$$
\left[\begin{array}{cc}
\nabla^2 f(x) & A^T \\
A & 0
\end{array}\right]
\left[\begin{array}{c}
v \\
w
\end{array}\right] = 
- 
\left[\begin{array}{c}
\nabla f(x) \\
0
\end{array}\right]
$$

O zaman bariyer metotu nedir? Bu metotla yine Newton metotunu uzatacaðýz,
ve eþitsizlik olan problemlerle uðraþacaðýz. 

$$
\min_x f(x) \quad \textrm{öyle ki}
$$
$$
Ax = b
$$
$$
h_i(x) \le 0, \quad i=1,..,m
\mlabel{3}
$$

Kriter dýþbükey, sýnýrlamalar lineer, ve dýþbükey eþitsizlik
sýnýrlamalarý, $h_i(x) \le 0$ ile.

Bariyer metotu eþitsizliklerle baþetmenin bir yolu. Eþitsizlik içeren
programlarýn en büyük problemi sýnýrlarda ne yapýlacaðýna karar vermek,
yani olurlu kümenin sýnýrlarýnda. Baþetmek için olurlu küme 
$C \equiv \{ x: h_i(x) \le 0 , i=1,..,m\}$ 

$$
\min_x f(x) + I_C(x)
$$
$$
Ax = b
$$

ile kritere dahil edilir, ki $I_C$ göstergeç fonksiyonudur. Ana fikir sýnýr
noktalarýnda iþler zorlaþýyorsa niye oralardan uzak durmuyoruz? Fakat
göstergeç fonksiyonu ile çalýþmak zor, onu da yaklaþýksal olarak temsil
ederiz, iþte bariyer fonksiyonu budur. Öyle bir fonksiyon seçeriz ki
sýnýrlarda aþýrý büyük deðerler vererek bizi minimizasyon baðlamýnda
oralardan ``geri iter''. Sanki sýnýrlara bir manyetik alan koyuyoruz,
oralara yaklaþýnca geri itiliyoruz. 

Tabii bir yandan Newton metotu da kullanabilmek istiyoruz, ideal olarak
pürüzsüz bir metot olursa elimizde iyi olur. Log bariyer fonksiyonu böyle
bir fonksiyon

$$
\phi(x) = -\sum_{i=1}^{m} \log(-h_i(x))
\mlabel{1}
$$

Böylece ana problemi þu hale getirebiliriz,

$$
\min_x f(x) + \frac{1}{t} \phi(x) \quad \textrm{öyle ki}
$$
$$
Ax = b
$$

ki $t>0$. Görülen $1/t$ dýþarýdan bizim tanýmladýðýmýz bir parametre,
optimizasyonu ayarlamak için kullanýyoruz onu. Eðer $t$ küçükse, sýfýra
yakýnsa o zaman bariyer baskýn haldedir (daha büyüktür), tabii o zaman
sýnýrlardan kaçmak optimizasyon için daha önemli hale gelir. Eðer $t$'yi
büyütürsek bu ``orijinal kriter $f$'ye daha fazla önem ver'' demektir.

Dersin geri kalanýnda üstteki format yerine alttaki ile çalýþacaðýz,
üstteki ile ayný, 

$$
\min_x t f(x) + \phi(x) \quad \textrm{öyle ki}
$$
$$
Ax = b
\mlabel{2}
$$

Log-Bariyer Calculus

(1) için türev

$$
\nabla \phi(x) = - \sum_{i=1}^{m} \frac{1}{h_i(x)} \nabla h_i(x)
$$

Hessian

$$
\nabla^2 \phi(x) = 
\sum _{i=1}^{m} \nabla h_i(x) \nabla h_i(x)^T - 
\sum _{i=1}^{m} \frac{1}{h_i(x)} \nabla^2 h_i(x)
$$

Örnek

Pek çok yerde kullanýlan bir eþitsizlik görelim, mesela bütün $x_i < 0$
olduðu bir durum, yani $h_i(x) = -x$. O zaman bariyer neye benzer? 

$$
\phi(x) = - \sum _{i=1}^{n} \log x_i
$$

$$
\nabla \phi(x) = 
- \left[\begin{array}{c}
1/x_1  \\ 
\vdots \\
1/x_n
\end{array}\right] 
= - X^{-1} \textbf{1} 
$$

Burada $X$ matrisi 

$$
X = \diag(x) = 
\left[\begin{array}{ccc}
x_1 & & \\
    & \ddots & \\
    & & x_n
\end{array}\right]
$$

ve $\textbf{1}$ sembolu tamamen 1'lerden oluþan matris. 

Hessian

$$
\nabla^2 \phi (x) = \left[\begin{array}{ccc}
1/x_1^2 & & \\
    & \ddots & \\
    & & 1/x_n^2
\end{array}\right] = X^2 
$$

Problemi yaklaþýk olarak temsil ettik. Uygun þartlarda problem (2)'nin
çözümü vardýr. Neden olduðunu görmek zor deðil, $\phi$ beni sýnýrlardan
uzak tutar, ve hedefim $f$'ye ulaþýrým, lineer diðer sýnýrlarý dikkate
alarak tabii. Gidis yolu neye benzerdi?

Merkezi gidiþ yolu, (1) için KKT koþullarý üzerinden gösterilebilir?  Bu
yol (1) probleminin $t$ üzerinden fonksiyon haline getirilmiþ
çözümüdür. Her $t$ için (1)'i çözebilirim, çözüme $x^*(t)$ derim, ve
$x^*$'ye $t$'nin bir fonksiyonu olarak bakýnca, bariyer metot çerçevesinde,
ortaya çýkan çözüm serisine merkezi gidiþ yolu denir. Her $t$ için (1)'in
çözümünü KKT koþullarý üzerinden temsil edebilirim, böylece her adýmda
$x^*(t)$'nin optimal olmasý için ne gerekir sorusunu formülize etmiþ
oluyorum.  Önce KKT ana olurluk þartlarý

$$
A x^* = b, \quad h_i(x^*(t)) \le 0
$$

Geri kalanlar, önce Lagrangian

$$
t f(x) + \phi(x) + w^T (Ax - b)
$$

Bu Lagrangian'in $x$ üzerinden gradyanýný alýp sýfýra eþitlersem duraðanlýk
þartýný elde ediyorum. 

$$
t \nabla f(x^*(t)) - \sum_{i=1}^{m} \frac{1}{h_i(x^* (t))} 
\nabla h_i(x^*(t)) + A^T w = 0
$$

Duraðanlýk için gradyan kullanmak yeterli çünkü tüm fonksiyonlar dýþbükey
ve pürüzsüz.

Üstteki problemi bazý herhangi bir $w$ için çözebilirsem o zaman merkezi
gidiþ yolundaki bir çözümü her $t$ için karakterize etmiþ olurum. Umudumuz
o ki $t$'yi sonsuzluða doðru iterken gördüðümüz KKT koþullarýnýn ima ettiði
çözümler orijinal problemdeki sonuçlara yaklaþsýn. Çünkü bariyer
fonksiyonunu $1/t$ ile çarptým ve $t$'yi büyüttükçe çarpým gösterge
fonksiyonuna yaklaþtýðýný biliyorum, o zaman optimizasyonu yaparken $t$'yi
büyüttükçe orijinal problemin gerçek sonucuna yaklaþmýþ olurum.

Þimdi bir lineer program üzerinden merkezi gidiþ yoluna bakalým. Basit bir
LP, eþitlik þartlarýný attým, 

$$
\min_x c^T x, \quad \textrm{öyle ki}
$$
$$
Dx \le e
$$

Bariyer olarak

$$
\min_x t c^T x - \sum _{i=1}^{m} \log(e_i - d_i^T x)
$$

Bu problemi belli bir $t$ için çözersem, sonra $t$'yi büyütürsem ve o yeni
$t$ için çözersem, bunu ardý ardýna yaparsam, umudum o ki orijinal LP'imin
sonucuna yaklaþacaðým.

\includegraphics[width=20em]{func_59_barr_01.png}

Resimde görüldüðü gibi, ortadan baþlýyoruz, $t=0$'da diyelim, ve $t$'yi
büyüttükçe yolda ilerliyoruz, ve sonuca eriþiyoruz. Gidiþ pürüzsüz, ve
LP'lerin karakterinden biliyoruz ki nihai sonuç çokyüzlümün (polyhedra)
ekstrem noktalarýnýn birinde olmalý. Yarý yolda $t=10$'daki bir nokta
egösteriliyor, nihai sonuç belki $t=100$'da [1, 26:59]

KKT koþulu üzerinden duraðanlýðý temiz bir þekilde gösterebiliyoruz, ya da
iç nokta ve ortada, merkezde bir yol takip edilmesini zorlama baðlamýnda,
merkezlik þartý da deniyor buna, gradyan alýnýnca

$$
= tc - \sum _{i=1}^{m} \frac{1}{e_i - d_t ^T x^(t)} d_i
$$

Bu demektir ki gradyan $\nabla (x*(t))$ $-c$'ye paralel olmalýdýr, ya da
$\{ x: c^T x = c^T x*(t)\}$ hiper düzlemi $\phi$'nin $x*(t)$'deki konturuna
teðet durmalýdýr. 

Birazdan merkezi yoldan ikiz noktalar alabileceðimizi göreceðiz. Bu çok
faydalý olacak çünkü bu ikiz noktalarý bir ikiz boþluðu hesaplamak için
kullanacaðýz. 

Merkezi yoldayken bu yoldaki noktalar $x*(t)$'leri kullanarak  ölürlü  ikiz
noktalar hesaplayabiliriz. Orijinal problem (3)'e tekrar bakarsak, bu
problem için ikiz deðiþkenleri elde etmek için her eþitsizlik için
bir $u_i$'ye, her eþitlik þartý için bir $v_i$'ya ihtiyacým var. Onlarý
nasýl tanýmlarým? Merkezi yol üzerindeki çözümler üzerinden,

$$
u_i^*(t) = \frac{1}{t h_i(x^*(t))}, \quad i=1,..,m, \quad v^*(t) = w/t
$$

$w$ bariyer problemi için KKT koþullarýný çözerken elde ettiðim deðiþken
idi. 

Niye üsttekiler orijinal problem için olurlu? Bunu görmek kolay, ilk önce,
$u_i^*(t)$'nin her ögesi harfiyen pozitif, çünkü $h_i(x^*(t))$'nin her
ögesi harfiyen negatif. Bu bariyer probleminin ana olurluk þartýndan
geliyor. Ayrýca $(u^*(t),v^*(t))$ Lagrange ikiz fonksiyonu $g(u,v)$'nin
taným kümesinde (domain). Hatýrlarsak Lagrange ikizi formülize ettiðimizde
taným kümesinde bazý dolaylý sýnýrlamalar elde ediyorduk. Tarif itibariyle

$$
\nabla f(x^*(t)) + \sum _{i=1}^{m} u_i (x^*(t)) \nabla h_i(x^*(t)) + 
A^T v^*(t) = 0
$$


Yani $x^*(t)$, Lagrangian $L(x,u^*(t),v^*(t))$'i tüm $x$'ler üzerinden
minimize edeceði için $g(u^*(t),v^*(t)) > -\infty$. Bu direk duraðanlýk
þartýndan geliyor iþte. O kadar bariz birþey ki aslýnda bazen kafa
karýþtýrýyor. Merkezi yol probleminden çözdüðümüz duraðanlýk koþulu
þöyleydi,

$$
t \nabla f(x^*(t)) - \sum \frac{1}{h_i(x^*(t))} \nabla h_i(x^*(t)) + A^T w= 0
$$

Bir $x^*$ çözümü ve $w$ olduðunu farz ediyoruz. Tüm formülü $t$ ile
bölersem,

$$
\nabla f(x^*(t)) - \sum \frac{1}{t h_i(x^*(t))} \nabla h_i(x^*(t)) + A^T \frac{w}{t}= 0
$$

Tek yaptýmýz ``üstteki orijinal problemdeki duraðanlýk þartýna çok
benziyor'' demek, deðil mi, çünkü 

$$
\nabla f(x^*(t)) +
\sum \underbrace{\frac{-1}{t h_i(x^*(t))}}_{u_i} \nabla h_i(x^*(t)) + 
A^T \underbrace{\frac{w}{t}}_{v}= 0
$$

desem, orijinal problemin duraðanlýk þartýna benzeyen bir ifade elde etmiþ
olurum [1, 33:48]. 




[devam edecek]

Kaynaklar

[1] Tibshirani, {\em Convex Optimization, Lecture Video 14}, 
\url{https://www.youtube.com/channel/UCIvaLZcfz3ikJ1cD-zMpIXg}   

[2] Tibshirani, {\em Convex Optimization, Lecture Video 15}, 
\url{https://www.youtube.com/channel/UCIvaLZcfz3ikJ1cD-zMpIXg}   

\end{document}



