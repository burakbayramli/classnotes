\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Koþulsal Olasýlýk ve Koþulsal Beklenti  (Conditional Probability, Conditional Expectation)

Olasýlýk teorisinin en faydalý tekniklerinden biri koþulsal olasýlýk ve koþulsal
beklentidir. Bunun iki sebebi var. Birincisi pratikte çoðunlukla elimizde bir
bilgi geçtiði durumda olasýlýk ve beklenti hesabý yaptýðýmýz, yani istediðimiz
hesaplarýn ``koþullu'' olmasý. Ýkincisi olasýlýk ya da beklenti hesabýnda bu
hesabý ilk önce bir baþka rasgele deðiþkene koþullamanýn çok faydalý olmasý.

Diyelim ki tavla oynarken iki zar atýyoruz, temel olasýlýktan biliyoruz ki her
seferinde 36 mümkün sonuçlardan biri ortaya çýkacak, mesela (1,2) ya da (5,5),
vs, o zaman, eðer zar hileli deðilse her sonucun olasýlýðý 1/36. Þimdi diyelim
ki ilk zarýn 4 geldiðini gördük, ve birisi diðer zarýn üstünü kapattý, ve bu
bilgi ýþýðýnda bize iki zarýn toplamýnýn 6 olma olasýlýðýnýn ne olduðunu
sordu. Ýlk zarýn 4 olduðu bilgisi verildiðine göre toplamý gözönüne almadan önce
altý tane mümkün sonucu düþüürüz,, (4,1), (4,2), (4,3), (4,4), (4,5), (4,6). Bu
seçeneklerin herbirinin ortaya çýkma ihtimali birbirine eþit. Biraz önceki
sonuçlarý olaylar olarak düþünürsek, $E$'yi iki zarýn toplamýnýn 6 olmasý olayý,
$F$'yi ilk zarýn 4 olma olayý olarak tanýmlayabiliriz, bu durumda aradýðýmýz
sonuç,

$$ P(E|F) $$

olarak gösterilir. Bu formülün açýlýmý

$$ P(E|F) = \frac{P(EF)}{P(F)}
\mlabel{1}$$

$P(EF)$ hem $E$ hem $F$ olaylarýnýn ayný anda olma olasýlýðý, yani $E$ kümesi ve
$F$ kümesinin kesiþimi. Bölendeki $P(F)$ bir anlamda $P(E|F)$ hesabýný $F$
bazýnda yapma amaçlý; çünkü $F$ olduðunu ``biliyoruz'' ve artýk örneklem
uzayýmýz $F$ haline geliyor, bu uzay içinde $E$'nin olma olasýlýðýna
bakýyoruz. Not: Hesabýn geçerli olmasý için $P(F)>0$ olmalý tabii ki. 

Biraz önceki örnek için aradýðýmýz cevap 1/6 çünkü altý mümkün sonuç içinde
sadece (4,2) olayý bizi ilgilendiriyor. 

Baðýmsýz Olaylar

Ýki olay $E,F$'nin birbirinden baðýmsýz olduðu söylenir, eðer

$$ P(EF) = P(E)P(F) $$

ise. (1) denklemi üzerinden bu

$$ P(E|F) = P(E) $$

sonucunu verir, bu sonuç akla yatkýn olmalý, eðer $E,F$ baðýmsýz ise, $F$'in
verilmiþ olmasý bize $E$ hakkýnda hiçbir þey söylemez. 

Bayes Formülü

Yine $E$ ve $F$ olaylarý var, ki $EF$ hem $E$, hem de $F$'nin olma durumu, o
zaman $E$

$$ E = EF \cup EF^c $$

olarak gösterilebilir çünkü bir öðenin $R$ içinde olmasý için ya $E$ ve $F$
içinde olmasý, ya da $E$ içinde olmasý ama $F$ içinde olmamasý lazýmdýr. $EF$ ve
$EF^c$ birbirlerinin tam tersi, karþýlýklý dýþarlayan (mütually exclusive)
olaylar olduklarý için alttaki doðru olacaktýr,

$$ P(E) = P(EF) + P(EF^c) $$

$$ = P(E|F)P(F) + P(E|F^c)P(F^c) $$

$$ = P(E|F)P(F) + P(E|F^c)(1-P(F)) $$

Üstteki son formül $P(E)$'nin bir aðýrlýklý ortalama olduðunu söylüyor;
aðýrlýklar $F$'in olma ve olmama olasýlýðý, ve bu aðýrlýklar $F$'nin olduðu ve
olmadýðýnýn verildiði durumdaki $E$ olasýlýklarýnýn aðýrlýklý ortalamasýný
alýyorlar.

Örnek

Bir hastalýk için bir labaratuarun test tekniðinin yüzde 95 baþarýsý var. Fakat
bu test bazen ``yanlýþ pozitif'' cevabý da verebiliyor; hasta olmayan kiþilerin
yüzde 1'i için, yani 0.01 olasýlýkla test hasta diyebiliyor. Eðer toplumun yüzde
0.5'inde bu hastalýðýn olduðu biliniyorsa, herhangi bir kiþinin testi pozitif
geldiðinde o kiþinin gerçekten hasta olma olasýlýðý nedir?

Cevap

$D$ test edilen kiþinin hasta olma olayý diyelim, $E$ testin pozitif
olmasý. Aradýðýmýz $P(D|E)$ olasýlýðý.

$$ P(D|E) = \frac{P(DE)}{P(E)} $$

$$
= \frac{P(E|D)P(D)}
{P(E|D)P(D) + P(E|D^c)P(D^c)}
\mlabel{2}
$$

$$
\frac{(0.95)(0.005)}
{(0.95)(0.005) + (0.01)(0.995)} $$

$$ = \frac{95}{294} \approx 0.323 $$

Yapýlan bazý hareketlere dikkat: 4 üstteki denklemde $P(DE)$'yi onun bir altýnda
$P(E|D)P(D)$, yani $P(ED)$'ye çevirdik, çünkü $P(DE)$ ile $P(ED)$ ayný þey.

Ayrýca çözüme yaklaþma þeklimiz istenen $P(D|E)$ için $P(E|D)$ ve onunla alakalý
olan rakamlarý kullanmak; problemde bildiðimiz $E$'nin verildiði durum deðil,
onun tersi, $D$'nin verildiði durum. Yani test tekniði hakkýnda elimizde bazý
bilgiler var, {\em bu bilgiler ýþýðýnda} test pozitif verirse bu sonuca ne kadar
inanalým diyoruz bir anlamda.

(2) formülü, onun ikiden fazla seçenek için ayrýksal, ya da sürekli olarak
genelleþtirilmiþ hali Bayes Formülü olarak biliniyor. 

Rasgele Degiskenler

Hatýrlayalým, iki olay $E,F$ için $P(F)>0$ ise, $F$'in verildiði durumda (koþul)
$E$'nin olasýlýðý

$$ P(E|F) = \frac{P(EF)}{P(F)} $$

O zaman $X,Y$ ayrýksal rasgele deðiþkenler ise $Y=y$ verildiði durumda $X$'in
koþulsal olasýlýk kütle fonksiyonunu (conditional probability mass function)
þöyle tanýmlayabiliriz,

$$ p_X(x|y) = P(X=x|Y=y) $$

$$ = \frac{P(X=x,Y=y)}{P(Y=y)} $$

$$ = \frac{p(x,y)}{p_Y(y)} $$

ki tüm $y$ deðerleri için $P(Y = y) > 0$ olmalý. Benzer þekilde $Y=y$
verildiði durumda $X$'in koþulsal olasýlýk daðýlým fonksiyonu, ki yine tüm $y$
deðerleri için $P(Y = y) > 0$ olacak þekilde,

$$ F_{X|Y}(x|y) = P(X \le x | Y=y) $$

$$ \sum _{a \le x} p_X(a|y)$$

Son olarak $Y=y$ verildigi durumda $X$'in kosulsal beklentisi,

$$ E(X|Y=y) = \sum _{x}x P(X=x | Y=y ) $$

$$ = \sum_x x p_X(x|y) $$

Yani herþey daha önce normal olasýlýk tanýmlarýnda olduðu gibi, sadece þimdi
tüm ifadeler $Y=y$ olayýna koþullu. Bunun söyleyebiliyoruz çünkü eðer $X$
$Y$'den baðýmsýz olsaydý

$$ p_X(x|y) = P(X=x|Y=y)  $$

$$ = P(X=x) $$

olurdu, ve bu formülü üstteki formüllerde koþullu olanýn yerine koyduðumuzda
normal olasýlýk denklemlerini elde ederdik.

Örnek

$p(x,y)$'in $X,Y$ rasgele deðiþkenlerinin ortak olasýlýk kütle fonksiyonu
olduðunu farz edelim, ve

$$ p(1,1) = 0.5, \quad
p(1,2) = 0.1, \quad
p(2,1) = 0.1, \quad
p(2,2) = 0.3
$$

olsun. $Y=1$'in verili olduðu durumda $X$'in olasýlýk kütle fonksiyonunu
hesaplayýn.

Çözüm

$Y$ sadece 1 olabileceðine göre, $p_{X|Y}(1|1)$ ve $p_{X|Y}(2|1)$'i hesaplanýrsa
iþ biter. Bu deðerleri ayrý ayrý bulacaðýz çünkü daðýlým bir formül deðil,
üstteki gibi sunulan ayrýksal olasýlýklarla her ihtimal ayrý çözülmeli.

$$ p_{X|Y}(1|1) = P(X=1|Y=1) = \frac{P(X=1,Y=1)}{P(Y=1)}
$$

$$ = \frac{p(1,1)}{p_Y(1)} = \frac{5}{6} $$

$p_Y(1)$'i nasil bulduk? Soyle,

$$ p_Y(1) = \sum_x p(x,1) = p(1,1) + p(2,1) = 0.6 $$

Ayrýca iki üstte $5/6$ oldu çünkü $0.5/0.6=5/6$. Devam edelim,

$$ p_{X|Y}(2|1) =
\frac{p(2,1)}{p_Y(1)} = \frac{1}{6}
$$

Sürekli Durum

Sürekli rasgele deðiþkenler için koþullu olasýlýk yoðunluk fonksiyonlarý 

$$ f_{X|Y}(x|y) = \frac{ f_{X,Y}(x,y)}{f_Y(y)} $$

Eðer koþullu yoðunluk üzerinden olay hesabý yapmak istersek, ve $f_Y(y) > 0$
olduðunu farzederek,

$$ P(X \in A | Y = y) = \int_A f_{X|Y}(x|y) \ud x $$

Örnek 

$$ f(x,y) = 
\left\{ \begin{array}{ll}
x+y & \textrm{eðer } 0 \le x \le 1, 0 \le y \le 1 \\
0 & \textrm{diðer}
\end{array} \right.
$$

$P(X < 1/4 | Y = 1/3)$ nedir? 

Cevap 

Üstteki olasýlýk hesabý için $f_{X|Y}$ fonksiyonuna ihtiyacýmýz var,

$$ f_Y(y) = \frac{ 1}{2} + y  $$

olsun. Ana formülümüz neydi? 

$$ f_{X|Y}(x|y) = \frac{f_{X,Y}(x,y)}{f_Y(y)} $$

$$ = \frac{ x+y }{\frac{1}{2} + y} $$

$$
P(X < 1/4 | Y = 1/3) = 
\int _{ 0}^{1/4} \frac{ x+ \frac{1}{3} }{\frac{1}{2} + \frac{1 }{3}} \ud x = 
\frac{\frac{1}{32}+ \frac{1}{3} }{\frac{1}{2} + \frac{1}{3}} = 
\frac{14}{32}
$$

Beklentileri Koþullayarak Hesaplamak

$E(X|Y)$ beklenti hesabýný düþünelim, bu hesap $Y$'nin bir fonksiyonu olacaktýr
bir bakýma, yani her $y$ için $E(X|Y=y)$ farklý bir sonuç verecektir. Önemli
nokta, $E(X|Y)$'nin kendisi de bir rasgele deðiþkendir. Koþulsal beklentinin çok
önemli özelliklerinden biri her $X,Y$ rasgele deðiþkeni için

$$ E(X) = E(E(X|Y)) $$

eþitliðinin doðru olmasýdýr. Biraz deðiþik bir notasyona göre,

$$ E_Y (E_{X|Y} (X|Y)) = E(X) $$

Ýspat

Ayrýksal durum için,

$$ E_Y (E_{X|Y} (X|Y)) = E_Y \bigg( \sum _{x} x \cdot P(X=x|Y) \bigg) $$

$$  = \sum_y \bigg( \sum _x x \cdot P(X=x|Y=y) \bigg) P(Y=y) $$

$$  = \sum_y  \sum _x x \cdot P(X=x|Y=y) P(Y=y) $$

$$  = \sum_x x \sum _y P(X=x|Y=y) P(Y=y) $$

$$  = \sum_x x \sum _y P(X=x,Y=y) $$

$$  = \sum_y x  P(X=x) $$

$$ = E(X) $$

Soru

Bir maden iþçisi kaza sonrasý bir madende týkalý kalýyor. Dýþarý çýkabilmesi
için önünde üç deðiþik kapý var; birinciyi seçerse 2 saat yürüdükten sonra
dýþarý çýkacak. Eðer ikinciyi seçerse 3 saat yürüdükten sonra tekrar madene
dönecek. Üçüncüyü seçerse bu sefer 5 saat yürüdükten sonra madene dönecek. Ýþçi
hangi kapýnýn onu dýþarý çýkartacaðýný bilmiyor, herhangi bir kapýyý eþit
olasýlýkla seçecek. Ýþçinin dýþarý çýkma süresinin beklentisi nedir?

Cevap

$X$ deðiþkeni iþçinin dýþarý çýkma süresini belirten rasgele deðiþken olsun,
$Y$ ise iþçinin ilk seçtiði kapý.

$$
E(X) = E(X | Y=1) P(Y=1) + E(X | Y=2) P(Y=2) +E(X | Y=3) P(Y=3) 
$$

$$
E(X) = \frac{1}{3} \big( E(X | Y=1)  + E(X | Y=2) +E(X | Y=3) \big)
\mlabel{3}
$$

Buraya kadar basit: Fakat sorudaki puf noktaya dikkat, eger kapi 2 ay da 3
secilirse isci tekrar madene donuyor, yani bastaki haline geri gelmis oluyor. O
zaman

$$ E(X|Y=1) = 2$$

$$ E(X|Y=2) = 3 + E(X) $$

$$ E(X|Y=3) = 5 + E(X) $$

Üstteki iki denklemi (3) içine koyarsak,

$$
E(X) = \frac{1}{3} \big( 2  + 3 + E(X) + 5 + E(X) \big)
$$

$$ E(X) = 10 $$

Ýþçinin dýþarý çýkma beklentisi 10 saattir.

Kaynaklar

[1] Ross, {\em Introduction to Probability Models, 10th Edition}

\end{document}
