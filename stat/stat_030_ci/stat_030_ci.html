<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"], cancelto: ["Extension","cancel"]
      });
    });
    </script>  
   
  <title>Güven Aralıkları</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
</head>
<body>
<div id="header">
</div>
<h1 id="güven-aralıkları">Güven Aralıkları</h1>
<p>Diyelim ki <span class="math inline">\(X_1,..,X_i\)</span> örneklemi birbirinden bağımsız, aynı dağılımlı ve ortalaması <span class="math inline">\(\mu\)</span>, standart sapması <span class="math inline">\(\sigma\)</span> ve yine aynı olan bir nüfus dağılımından geliyor. O zaman biliyoruz ki, Merkezi Limit Teorisi (Central Limit Theorem) teorisine göre, <span class="math inline">\(n\)</span> arttıkça örneklem ortalaması <span class="math inline">\(\bar{X} = \frac{1}{n} X_1+..+X_n\)</span>, ortalaması <span class="math inline">\(\mu\)</span>, standart sapması <span class="math inline">\(\sigma/n^2\)</span> olan bir normal dağılıma yaklaşıyor.</p>
<p>Peki veriyi (yani örneklemi) ve CLT'yi kullanarak <span class="math inline">\(\mu\)</span> hakkında bir tahmin yapabilir miyiz? Yani Büyük Sayılar Kanunua göre <span class="math inline">\(\mu\)</span> hakkında noktasal tahmin yapabiliriz fakat, belki ondan bir adım ötesi, bir &quot;güven aralığı'' hesaplamaktan bahsediyoruz. Bu tahmin &quot;gerçek <span class="math inline">\(\mu\)</span>, %95 ihtimalde şu iki değer arasındadır'' türünde bir tahmin olacak.</p>
<p>Dikkat: burada verinin yüzde kaçının belli bir aralıkta olup olmadığından bahsetmiyoruz, tahminsel hesabı yapılan ortalamanın hangi güven seviyesinde bir aralıkta olup olmadığından bahsediyoruz. Verinin güven aralığı hakkındaki notlar bu yazının sonunda.</p>
<p>Bu aralığın hesabı için önce <span class="math inline">\(\bar{X}\)</span>'i standardize edelim, yani <span class="math inline">\(N(0,1)\)</span> haline çevirelim,</p>
<p><span class="math display">\[ Z = \frac{\bar{X} - \mu}{\sigma / \sqrt{n}} \]</span></p>
<p>Z-skorlarını işlediğimiz yazıda</p>
<p><span class="math display">\[
P(z_1 &lt; Z &lt; z_2) =  \Phi(z_1) - \Phi(z_2) 
\]</span></p>
<p>gibi bir ifade gördük. Eşitliğin sağ tarafı aslında bir alan hesabıdır, sürekli fonksiyonlarda olasılık bir entegral, ya da iki kümülatif yoğunluk fonksiyonunun farkı. Güven aralığı için bize lazım olan da bir olasılık, hatta &quot;kesin'' bir olasılık, %95 olasılığı. Demek ki eşitliğin sağ tarafı .95 olacak. .95 hesabı için, normal eğrisini düşünürsek, sağından ve solundan 0.25 büyüklüğünde iki parçayı &quot;kırpmamız'' lazım. O zaman 0.975 olasılığının z değeri ile, 0.025 olasılığının z değeri arasındaki olasılıkta olmamız lazım. Bu hesaplarda baz alınan <span class="math inline">\(z_{\alpha/2}\)</span> değeri ve bu <span class="math inline">\(100 \cdot \alpha / 2\)</span> üst yüzdelik kısmına, örneğimizde 0.975 kısmına tekabül ediyor. Normal dağılımın simetrisi sebebiyle onun eksisi alınmış hali öteki (soldaki) parçayı verir, yani <span class="math inline">\(-z_{\alpha/2}\)</span>.</p>
<div class="figure">
<img src="stat_ci_03.png" />

</div>
<p>Z-skoru hesaplarken tabloya danışmıştık, şimdi tabloya tersinden bakacağız, kesişme noktasında 0.975 diyen yeri bulup kordinatları alacağız, ki bu değer 1.96.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> scipy.stats.distributions <span class="im">import</span> norm
<span class="bu">print</span> norm.ppf(<span class="fl">0.975</span>)</code></pre></div>
<pre><code>1.95996398454</code></pre>
<p>Bazı İstatistik kaynaklarında &quot;sihirli değer'' şeklinde tarif edilen bir değer bu, gözlerimiz kamaşmasın, geldiği yer burası işte. Şimdi formülü buna göre değiştirelim,</p>
<p><span class="math display">\[ 
P \bigg( 
-z_{\alpha/2} \
\le \frac{\bar{X} - \mu}{\sigma / \sqrt{n}} 
\le z_{\alpha/2}
\bigg) = 1-\alpha
\]</span></p>
<p><span class="math inline">\(P(\cdot)\)</span> içinde biraz düzenleme, tüm terimleri <span class="math inline">\(\sigma / \sqrt{n}\)</span> ile çarpalım, <span class="math inline">\(\bar{X}\)</span> çıkartalım, ve <span class="math inline">\(-1\)</span> ile çarpalım,</p>
<p><span class="math display">\[ 
P \bigg( 
\bar{X} - z_{\alpha/2}\frac{\sigma}{\sqrt{n}}
\le \mu
\le \bar{X} + z_{\alpha/2}\frac{\sigma}{\sqrt{n}}
\bigg) = 1-\alpha
\qquad (1)
\]</span></p>
<p>Güven aralığı ifadesine aslına erişmiş olduk. Eğer %95 kesinlikten bahsediyor olsaydık, ve nüfusun gerçek varyansı <span class="math inline">\(\sigma^2\)</span> biliniyor olsaydı, <span class="math inline">\(P(\cdot)\)</span> içine bu değerleri geçecektik, <span class="math inline">\(\bar{X}\)</span> zaten verinin aritmetik ortalamasından ibarettir, bu bize <span class="math inline">\(\mu\)</span>'nun solunda ve sağında bazı değerler döndürecekti. Bu değerler bizim güven aralığımız olacaktı. Mesela veri 64.1, 64.7, 64.5, 64.6, 64.5, 64.3, 64.6, 64.8, 64.2, 64.3 şeklinde, <span class="math inline">\(n=10\)</span> çünkü 10 nokta var, <span class="math inline">\(\sigma = 1\)</span> olarak verilmiş. Ortalamayı hesaplıyoruz, 64.46. <span class="math inline">\(\alpha=0.05\)</span> için</p>
<p><span class="math display">\[ 
P \bigg( 
64.46 - 1.96\frac{1}{\sqrt{10}}
\le \mu
\le 64.46 + 1.96\frac{1}{\sqrt{10}}
\bigg) = 0.95
\]</span></p>
<p><span class="math display">\[ P\bigg(63.84 \le \mu \le 65.08\bigg) = 0.95 \]</span></p>
<p>Yani %95 güven aralığı <span class="math inline">\(63.84 \le \mu \le 65.08\)</span>.</p>
<p>Neler yaptık? CLT bilgisinden hareketle <span class="math inline">\(\bar{X}\)</span> hakkında bir şeyler biliyorduk. Fakat <span class="math inline">\(\bar{X}\)</span>'in <em>kesin</em> hangi normal dağılıma yaklaştığını bilmek için nüfus paremetreleri <span class="math inline">\(\mu,\sigma\)</span> da bilinmelidir. Diğer yandan eğer tek bilinmeyen <span class="math inline">\(\mu\)</span> ise, teoriyi bu bilinmez etrafında tamamen tekrar şekillendirip / değiştirip CLT'yi bilinmeyen <span class="math inline">\(\mu\)</span> etrafında bir güven aralığı yaratmak için kullandık.</p>
<p>Not: Eğer <span class="math inline">\(\sigma\)</span> bilinmiyor ise onu da veriden hesaplarız, <span class="math inline">\(S^2\)</span> tahmin edicisi ile, yanlız bu durumda <span class="math inline">\(S^2\)</span> te bir dağılıma sahip olacaktır, <span class="math inline">\(\chi^2\)</span> dağılımı, ve üstte <span class="math inline">\(P()\)</span> içindeki bölüm bir Normal rasgele değişkeni bolu <span class="math inline">\(\chi^2\)</span> bölümü haline gelir, ki bu bölüm Öğrenci t dağılımı adında başka bir dağılıma sahiptir! O zaman üstteki cebirsel hareketleri bunu hesaba katarak yapmak gerekir. Bunun detaylarını ilerideki bir bölümde göreceğiz.</p>
<p>Kac Tane <span class="math inline">\(n\)</span>?</p>
<p>Hatırlarsak güven aralığını üstteki şekilde hesaplayabilmemizin sebebi CLT sayesinde <span class="math inline">\(\bar{X}\)</span>'in normal dağılıma yaklaşıyor olmasıydı. Ve, teoriyi tekrar düşünürsek yaklaşma <span class="math inline">\(n \to \infty\)</span> olduğu zaman oluyordu. Buradan <span class="math inline">\(\bar{X}\)</span>'in normalliğinin &quot;büyükçe'' <span class="math inline">\(n\)</span> değerleri için daha geçerli olacağı sonucuna varabiliriz. Peki <span class="math inline">\(n\)</span> ne kadar büyük olmalı? Literatüre göre CLT'nin genellikle <span class="math inline">\(n \ge 30\)</span> durumunda geçerli olduğu söylenir. Tabii nüfus dağılımının ne olduğu da önemlidir, eğer nüfus normal ise, ya da genel olarak simetrik tek tepeli dağılım ise örneklem daha ufak kalsa da bazı sonuçlara varabiliriz. Eğer nüfus dağılımı çok yamuk (skewed), etekleri geniş dağılım ise o zaman daha büyük örneklem daha iyi olur.</p>
<p>Soru</p>
<p>İÖ 800 yıllarında İtalya'da Etrusyalı (Etruscan) toplumu vardı, bilinmeyen bir sebeple bu insanlar geldikleri gibi birdenbire ortadan kayboluverdiler. Bilimciler bu toplumun İtalyalılar ile fizyolojik, genetik ve kültürel olarak bağlantısı olup olmadığını hep merak etmiştir. Bazıları hafa ölçülerine bakarak sonuçlara varmaya uğraşmıştır. Arkeolojik kazılarda yapılan ölçümlerde 84 Etrusyalının kafası ölçülmüştür. Ayrıca bugünkü İtalyanların kafa ölçümlerinin normal dağılımda <span class="math inline">\(\mu=132.4 mm,\sigma=6.0mm\)</span> olduğu bilinmektedir. İki toplum arasındaki bağlantı kurmak için, veriye bakarak kafa ölçümü ortalaması için bir %95 güvenlik aralığı oluşturabiliriz, ve eğer bugünkü İtalyanların ölçüsü o aralığa düşmüyorsa, Etrusyalılarla bağlantılarının olmadığını iddia edebiliriz.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd
dfetr <span class="op">=</span> pd.read_csv(<span class="st">&#39;../stat_035_tests/etrus.csv&#39;</span>)
<span class="bu">print</span> (<span class="bu">float</span>(dfetr.mean()<span class="op">-</span><span class="fl">1.96</span><span class="op">*</span>(<span class="fl">6.0</span><span class="op">/</span>np.sqrt(<span class="dv">84</span>))))
<span class="bu">print</span> (<span class="bu">float</span>(dfetr.mean()<span class="op">+</span><span class="fl">1.96</span><span class="op">*</span>(<span class="fl">6.0</span><span class="op">/</span>np.sqrt(<span class="dv">84</span>))))</code></pre></div>
<pre><code>142.524107721075
145.09035011025028</code></pre>
<p>Bugünkü İtalyanların kafa ortalaması <span class="math inline">\(\mu=132.4\)</span> bu aralığa düşmüyor. Diğer bir deyişle, 84 tane örneklemden gelen örneklem ortalaması 143.8 büyük bir ihtimalle <span class="math inline">\(\mu=132.4,\sigma=6.0\)</span> boyutlarındaki bir normal dağılımdan gelmemiştir. Buna göre, büyük bir ihtimalle Etrusyalılar İtalyanların atası değildir.</p>
<p>Bilinmeyen <span class="math inline">\(\sigma\)</span></p>
<p>Güven Aralıkları bölümünden devam edelim. Bilinmeyen <span class="math inline">\(\mu\)</span> durumunu gördük. Eğer <span class="math inline">\(\sigma\)</span> bilinmiyorsa, bu durumda <span class="math inline">\(\sigma\)</span> yerine örneklem varyansı <span class="math inline">\(S\)</span> kullanılabilir,</p>
<p><span class="math display">\[ S^2 = \frac{1}{n} \sum (X_i - \bar{X})^2
\]</span></p>
<p>ki üstteki değerin karekökü <span class="math inline">\(S\)</span> olacaktır. <span class="math inline">\(\sigma\)</span> yerine <span class="math inline">\(S\)</span> kullanmanın büyük <span class="math inline">\(n\)</span> değerlerinde CLT'yi etkilemediği ispat edilmiştir [5]. Fakat daha küçük örneklem durumunda t Dağılımı daha uygun olur.</p>
<p>T Dağılımı</p>
<p>Daha önce Z oranını temel alarak güven aralıkları ya da hipotez testleri oluşturmuştuk. Bu işlemler için standart normal dağılımın üst ve alt yüzdelikleri hakkında bazı bilgiler gerekmişti. Bu bilgiler bir tablodan bakılan değerlerdi ya da istatistik yazılımımızda gerekli bir çağrı ile hemen bulunabiliyorlardı.</p>
<div class="figure">
<img src="stat_ci_04.png" />

</div>
<p>Öğrenci t'nin Z'ye göre farklı bir tarafı belli bir değeri bulmak için iki parametreye ihtiyaç olması, bunlardan biri <span class="math inline">\(\alpha\)</span> diğeri ise serbestlik derecesi (degree of freedom -dof-). Standart normal için tablo paylaştık, fakat t için artık tablolarla uğraşmayacağız, bilgisayar çağındayız, yazılım ile bu işi halledelim!</p>
<p>Örnek</p>
<p><span class="math inline">\(T\)</span> bir Öğrenci t dağılımı ise, ve serbestlik derecesi 3 ise, <span class="math inline">\(\alpha=0.01\)</span> için için <span class="math inline">\(f_T(t)\)</span>'nin <span class="math inline">\(100(1-\alpha)\)</span> yüzdeliği nedir? Üstteki grafikteki <span class="math inline">\(t_{\alpha,n}\)</span> notasyonundan hareketle <span class="math inline">\(t_{0.01,3}\)</span> değerini arıyoruz yani.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> scipy.stats.distributions <span class="im">import</span> t
df <span class="op">=</span> <span class="dv">3</span>
<span class="bu">print</span> t.ppf(<span class="fl">0.99</span>,df)
<span class="bu">print</span> <span class="dv">1</span><span class="op">-</span>t.cdf(<span class="fl">4.541</span>,df)</code></pre></div>
<pre><code>4.5407028587
0.00999823806449</code></pre>
<p>Yani</p>
<p><span class="math display">\[ P(T_3 \ge 4.541) = 0.01 \]</span></p>
<p><span class="math inline">\(\frac{\bar{Y}-\mu}{S/\sqrt{n}}\)</span> ifadesinin n-1 derece serbestliğe sahip Öğrenci t dağılımına sahip olduğunu bilmek alttaki ifadeyi mümkün kılar,</p>
<p><span class="math display">\[ P \bigg(
-t_{\alpha/2,n-1} \le
\frac{\bar{Y}-\mu}{S/\sqrt{n}} \le 
t_{\alpha/2,n-1}
\bigg) = 1-\alpha
\]</span></p>
<p>Bu ifadeyi daha önce standart normal için yaptığımız gibi tekrar düzenlersek,</p>
<p><span class="math display">\[ P \bigg(
\bar{Y}-t_{\alpha/2,n-1}\frac{S}{\sqrt{n}} \le
\mu \le 
\bar{Y}+t_{\alpha/2,n-1}\frac{S}{\sqrt{n}}
\bigg) = 1-\alpha
\]</span></p>
<p>Tabii, <span class="math inline">\(Y_i\)</span>'ların normal dağılımdan gelmiş olması lazım. Bunun sonucunda gerçek veri temel alınarak hesaplanacak <span class="math inline">\(S\)</span> ve <span class="math inline">\(\bar{Y}\)</span> bize <span class="math inline">\(\mu\)</span> için bir <span class="math inline">\(\%100(1-\alpha)\)</span> güven aralığı verecektir.</p>
<p>Örnek</p>
<p>Yapışkan elementlerin üzerinde yapılan deneyler sonucundaki ölçümler altta verilmiştir. Acaba <span class="math inline">\(\mu\)</span> için %95 güven aralığı nedir?</p>
<p>Öncelikle verinin normal dağılımdan geldiği doğru mudur? Bu faraziyeyi kontrol etmemiz gerekir yoksa t dağılımını kullanamayız. Önce bir kutu grafiği (boxplot) yapalım,</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">data <span class="op">=</span> np.array([<span class="fl">19.8</span>,<span class="fl">10.1</span>,<span class="fl">14.9</span>,<span class="fl">7.5</span>,<span class="fl">15.4</span>,<span class="fl">15.4</span>,<span class="fl">15.4</span>,<span class="fl">18.5</span>,<span class="fl">7.9</span>,<span class="fl">12.7</span>,
<span class="fl">11.9</span>,<span class="fl">11.4</span>,<span class="fl">11.4</span>,<span class="fl">14.1</span>,<span class="fl">17.6</span>,<span class="fl">16.7</span>,<span class="fl">15.8</span>,<span class="fl">19.5</span>,<span class="fl">8.8</span>,<span class="fl">13.6</span>,<span class="fl">11.9</span>,<span class="fl">11.4</span>])
plt.boxplot(data)
plt.savefig(<span class="st">&#39;stat_ci_01.png&#39;</span>)</code></pre></div>
<div class="figure">
<img src="stat_ci_01.png" />

</div>
<p>Şimdi normal olasılık grafiği (normal probability plot) yapalım, ki bu grafik verinin normal dağılıma ne kadar uyumlu olduğunu grafik olarak gösterir, eğer uyumlu ise veri düz çizgiye yakın çıkmalıdır,</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> scipy.stats <span class="im">as</span> stats
res <span class="op">=</span> stats.probplot(data, plot<span class="op">=</span>plt)
plt.savefig(<span class="st">&#39;stat_ci_02.png&#39;</span>)</code></pre></div>
<div class="figure">
<img src="stat_ci_02.png" />

</div>
<p>Bu grafiklere bakınca verinin normal olduğu belli oluyor. Zaten örneklem sayısı az, bu sebeple t dağılımı kullanmak uygun. Veri sayısal ortalaması ve sayısal standart sapmasına bakalım, ve güven aralığını hesaplayalım, yani</p>
<p><span class="math display">\[ \bar{x} - t_{\alpha/2,n-1}s/\sqrt{n} \le
\mu \le
 \bar{x} + t_{\alpha/2,n-1}s/\sqrt{n}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> scipy.stats.distributions <span class="im">import</span> t
n <span class="op">=</span> <span class="bu">len</span>(data)
dof <span class="op">=</span> <span class="bu">len</span>(data)<span class="op">-</span><span class="dv">1</span>
m <span class="op">=</span> np.mean(data)
s <span class="op">=</span> np.std(data)
<span class="bu">print</span> <span class="st">&#39;ortalama&#39;</span>,m
<span class="bu">print</span> <span class="st">&#39;sapma&#39;</span>,s
<span class="bu">print</span> m <span class="op">+</span> t.ppf(<span class="fl">0.025</span>,dof) <span class="op">*</span> s <span class="op">/</span> np.sqrt(n),<span class="op">\</span>
      m <span class="op">-</span> t.ppf(<span class="fl">0.025</span>,dof) <span class="op">*</span> s <span class="op">/</span> np.sqrt(n)</code></pre></div>
<pre><code>ortalama 13.7136363636
sapma 3.47187340764
12.174293931 15.2529787962</code></pre>
<p>Güven aralığı oldukça geniş, çünkü (demek ki) ölçümlerde yüksek değişkenlik var.</p>
<p>Normal Nüfusun Varyansının Güvenlik Aralığı</p>
<p>Bazen nüfusun varyansı ya da standart sapması üzerinde bir güven aralığı hesaplamak gerekebilir. Eğer nüfus normal olarak dağılmış ise, şimdiye kadar gösterdiğimiz tekniklerin hepsi kullanılabilir. (1) teorisinin b kısmındaki ifadeyi kullanırsak, nüfusu <span class="math inline">\(\mu,\sigma\)</span> parametreli bir normalden alınan <span class="math inline">\(X_1,..,X_n\)</span> örneklemi üzerinden hesaplanan <span class="math inline">\(X^2 = \frac{(n-1)S^2}{\sigma^2}\)</span> ifadesinin <span class="math inline">\(n-1\)</span> serbestlik derecesindeki bir chi kare dağılımı olduğunu biliyoruz.</p>
<p>Chi karenin yüzdelik kısımları altta görülebilir,</p>
<div class="figure">
<img src="chi_1.png" />

</div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> scipy.stats.distributions <span class="im">import</span> chi2
<span class="bu">print</span> chi2.ppf(<span class="fl">0.05</span>,<span class="dv">5</span>)
<span class="bu">print</span> chi2.ppf(<span class="fl">0.99</span>,<span class="dv">5</span>)</code></pre></div>
<pre><code>1.14547622606
15.0862724694</code></pre>
<p>Dikkat edilmesi gereken bir konu chi karenin yamuk (skewed) olması sebebiyle sağdaki ve soldaki alan hesaplarının arasında z skorunda olduğu gibi her seferinde birebir geçiş yapılamayabileceği.</p>
<p>Notasyonel olarak <span class="math inline">\(\chi_{p,n}^2\)</span> ifadesi, x eksenindeki bir eşik noktasını ifade eder ki bu değerin sol tarafındaki alan büyüklüğü <span class="math inline">\(p\)</span>, <span class="math inline">\(n\)</span> serbestlik derecesindeki chi kare dağılımının alanıdır. Mesela üstte <span class="math inline">\(\chi_{0.05,5}^2 = 1.145\)</span> ve <span class="math inline">\(\chi_{0.99,5}^2 = 15.086\)</span>. Olasılık ifadesi olarak</p>
<p><span class="math display">\[ P(\chi_5^2 \le 1.145) = 0.05 \]</span></p>
<p><span class="math display">\[ P(\chi_5^2 \le 15.086) = 0.05 \]</span></p>
<p>Not: Bazı kaynaklar eşik değerinin sağ kısmını referans alıyor her nedense, bu duruma dikkat.</p>
<p><span class="math inline">\(\sigma^2\)</span> İçin Güvenlik Aralığı</p>
<p>Chi kare tanımından hareketle şu ifadeyi yazabiliriz,</p>
<p><span class="math display">\[ P\bigg(
\chi_{\alpha/2,n-1}^2 \le
\frac{(n-1)S^2}{\sigma^2}  \le
\chi_{1-\alpha/2,n-1}^2
\bigg) = 1-\alpha
\]</span></p>
<p>Belirtildiği üzere, üstteki ifadenin <span class="math inline">\(Z\)</span>'li halinde olduğu gibi, bir z değerini alıp, eksi ile çarparak (ve çarpmayarak) hem sol hem sağda eşik değeri olarak kullanamadık çünkü chi kare simetrik değil. Eşik değerinin belli noktalarda ayrı ayrı hesaplanması gerekiyor.</p>
<p>Üstteki denklem birkaç cebirsel işlem sonrasında <span class="math inline">\(\sigma^2\)</span>'yi ortada tek başına bırakacak şekilde değiştirilebilir, önce eşitsizlikleri tersine çeviriyoruz, aynı anda ortadaki bölüme tersine çeviriyoruz, ve yeni böleni hem sol hem sağa çarparak taşıyoruz,</p>
<p><span class="math display">\[
P
\bigg(
\frac{(n-1)S^2}{\chi_{1-\alpha/2,n-1}^2} \le
\sigma^2  \le
\frac{(n-1)S^2}{\chi_{\alpha/2,n-1}^2} 
\bigg) = 1-\alpha
\]</span></p>
<p>Eşitsizliğin karekökünü alırsak, <span class="math inline">\(\sigma\)</span> için <span class="math inline">\(\%100(1-\alpha)\)</span> güven aralığı</p>
<p><span class="math display">\[
\bigg(
\sqrt{\frac{(n-1)S^2}{\chi_{1-\alpha/2,n-1}^2}}
,
\sqrt{\frac{(n-1)S^2}{\chi_{\alpha/2,n-1}^2}}
\bigg) 
\]</span></p>
<p>Örnek</p>
<p>Bir fabrikada deterjanları doldurmak için bir makina kullanılıyor. Rasgele seçilen bir örneklemde 20 tane deterjan plastik şişeden alınan ölçümlerde örneklem varyansının <span class="math inline">\(s^2 = 0.0153\)</span> olduğu hesaplanıyor (birim <span class="math inline">\(ons^2\)</span>). Bu ölçümlerin standart sapması <span class="math inline">\(\sigma^2\)</span> için %95'lik üst güven sınırı nedir?</p>
<p><span class="math display">\[ 
\sigma^2 \le
\sqrt{\frac{(19)0.0153}{\chi_{0.05,19}^2}}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> scipy.stats.distributions <span class="im">import</span> chi2
<span class="bu">print</span> chi2.ppf(<span class="fl">0.05</span>,<span class="dv">19</span>)</code></pre></div>
<pre><code>10.1170130639</code></pre>
<p><span class="math display">\[ 
\sigma^2 \le
\sqrt{\frac{(19)0.0153}{10.117}} = 0.0287
\]</span></p>
<p>Yani</p>
<p><span class="math display">\[ \sigma \le 0.17 \]</span></p>
<p>Demek ki nüfusun gerçek standart sapması 0.17 ons kadar büyük olabilir.</p>
<p>Nüfus Ortalama Farkı, <span class="math inline">\(\mu_1-\mu_2\)</span> Güven Aralığı</p>
<p>İki farklı nüfusun ortalamaları <span class="math inline">\(\mu_1,\mu_2\)</span>'nin birbirinden farklı olup olmadığını, ve bu farkın istatistiki önemli olup olmadığını nasıl anlarız? Bir yaklaşım, iki nüfusun örneklem ortalaması <span class="math inline">\(\bar{X}_1,\bar{X}_2\)</span>'i kullanmak ve farklılık <span class="math inline">\(\mu_1-\mu_2\)</span>' için bir güven aralığı oluşturmak, eğer sıfır değeri bu aralık içine düşüyorsa, farklılık vardır. Birbirinden aynı olan şeylerin farkı sıfır olduğuna göre eğer sıfır güven aralığı içinde ise bu iki nüfusun ortalamasının birbirine yakın olduğundan emin olabiliriz.</p>
<p>Devam edelim; Merkezi Limit Teorisi'ne göre yeterince büyük örneklemler, yani <span class="math inline">\(n_1&gt;30,n_2&gt;30\)</span> için, <span class="math inline">\(\bar{X}_1,\bar{X}_2\)</span> Normal olarak dağılmaya mecbur.</p>
<p>Diğer yandan biliyoruz ki iki Normal dağılımın toplamı, ya da çıkartılması yeni bir Normal dağılım verir. <span class="math inline">\(\mu_a,\mu_b\)</span> ve <span class="math inline">\(\sigma_a,\sigma_b\)</span> için, toplam <span class="math inline">\(N(\mu_a+\mu_b, \sigma_a+\sigma_b)\)</span> elde edilir. Örneklem durumunda ve çıkartma sonrası yeni ortalama ve standart sapma</p>
<p><span class="math display">\[ \mu_1-\mu_2, \qquad \frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}\]</span></p>
<p>olacaktır [1, sf. 257].</p>
<p>Ayrıca <span class="math inline">\(\mu\)</span> ortalamasına, <span class="math inline">\(\sigma\)</span> varyansına sahip bir <span class="math inline">\(\bar{X}\)</span>'i</p>
<p><span class="math display">\[ Z = \frac{\bar{X}-\mu}{\sigma/\sqrt{n}} \]</span></p>
<p>ile standart normal <span class="math inline">\(Z = N(0,1)\)</span>'e cevirilebileceğimizi biliyoruz.</p>
<p>O zaman yaklaşım şöyle olabilir; <span class="math inline">\(\bar{X}_1-\bar{X}_2\)</span>'i hesaplarız, bu dağılımın kesinlikle normal olduğunu biliyoruz; o zaman nüfus ortalama ve standart sapması üzerinden standardizasyon ve biraz cebirsel cambazlık ile <span class="math inline">\(\mu_1-\mu_2\)</span> için bir güven aralığı oluştururuz.</p>
<p><span class="math display">\[ 
Z =
\frac{\bar{X}_1-\bar{X}_2 - (\mu_1-\mu_2)}
{\sqrt{\sigma_1^2/n_1 + \sigma_2^2/n_2}}
\]</span></p>
<p><span class="math display">\[ 
P \bigg(
-z_{\alpha/2} \le 
\frac{\bar{X}_1-\bar{X}_2 - (\mu_1-\mu_2)} {\sqrt{\sigma_1^2/n_1 + \sigma_2^2/n_2}} \le
z_{\alpha/2} 
\bigg) = 1-\alpha
\]</span></p>
<p><span class="math display">\[ 
P[
(\bar{X}_1 - \bar{X}_2) - z_{\alpha/2}\sigma_w \le
\mu_1-\mu_2 \le
(\bar{X}_1 - \bar{X}_2) + z_{\alpha/2}\sigma_w 
] = 1-\alpha
\]</span></p>
<p>ki <span class="math inline">\(\sigma_w = \sqrt{\sigma_1^2/n_1 + \sigma_2^2/n_2}\)</span>. Eğer <span class="math inline">\(\sigma\)</span> bilinmiyorsa, onun yerine, yine yeterince büyük örneklem için örneklem standart sapması <span class="math inline">\(s\)</span> kullanılabilir.</p>
<p><span class="math inline">\(\sigma^2\)</span> için yansız (unbiased) tahmin edici</p>
<p><span class="math display">\[ s^2 = \sigma_i (X_i-\bar{X})^2 / (n-1) \]</span></p>
<p>Not: Kaynaklarda çoğunlukla <span class="math inline">\(\sigma^2\)</span> yerine <span class="math inline">\(s^2\)</span> kullanılırsa <span class="math inline">\(Z\)</span> yerine <span class="math inline">\(T\)</span> yani Öğrenci T dağılımı kullanılması tavsiye edilir, fakat eğer örneklem yeterince büyük ise <span class="math inline">\(Z\)</span> kullanımında problem yoktur [3, sf. 544].</p>
<p>Bir biyolog erkek ve dişi çekirgelerin uzunluk ölçümünü (ölçek milimetre) alıyor. Bu iki ölçümlerin ortalaması birbirinden farklı mıdır?</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">a <span class="op">=</span> [<span class="fl">5.20</span>, <span class="fl">4.70</span>, <span class="fl">5.75</span>, <span class="fl">7.50</span>, <span class="fl">6.45</span>, <span class="fl">6.55</span>, <span class="fl">4.70</span>, <span class="fl">4.80</span>, <span class="fl">5.95</span>, <span class="op">\</span>
<span class="fl">5.20</span>, <span class="fl">6.35</span>, <span class="fl">6.95</span>, <span class="fl">5.70</span>, <span class="fl">6.20</span>, <span class="fl">5.40</span>, <span class="fl">6.20</span>, <span class="fl">5.85</span>, <span class="fl">6.80</span>, <span class="op">\</span>
<span class="fl">5.65</span>, <span class="fl">5.50</span>, <span class="fl">5.65</span>, <span class="fl">5.85</span>, <span class="fl">5.75</span>, <span class="fl">6.35</span>, <span class="fl">14.1</span>, <span class="fl">12.2</span>, <span class="fl">14.0</span>, <span class="fl">14.6</span>, <span class="op">\</span>
<span class="fl">5.75</span>, <span class="fl">5.95</span>, <span class="fl">5.90</span>, <span class="fl">7.00</span>, <span class="fl">6.10</span>, <span class="fl">5.80</span>]

b <span class="op">=</span> [<span class="fl">8.25</span>, <span class="fl">9.95</span>, <span class="fl">5.90</span>, <span class="fl">7.05</span>, <span class="fl">8.45</span>, <span class="fl">7.55</span>,<span class="op">\</span>
<span class="fl">9.80</span>, <span class="fl">10.80</span>, <span class="fl">6.60</span>, <span class="fl">7.55</span>, <span class="fl">8.10</span>, <span class="fl">9.10</span>, <span class="op">\</span>
<span class="fl">6.10</span>, <span class="fl">9.30</span>, <span class="fl">8.75</span>, <span class="fl">7.00</span>, <span class="fl">7.80</span>, <span class="fl">8.00</span>, <span class="op">\</span>
<span class="fl">9.00</span>, <span class="fl">6.30</span>, <span class="fl">8.35</span>, <span class="fl">8.70</span>, <span class="fl">8.00</span>, <span class="fl">7.50</span>, <span class="op">\</span>
<span class="fl">9.50</span>, <span class="fl">8.30</span>, <span class="fl">7.05</span>, <span class="fl">8.30</span>, <span class="fl">7.95</span>, <span class="fl">9.60</span> ]
a <span class="op">=</span> np.array(a)
b <span class="op">=</span> np.array(b)

ma <span class="op">=</span> np.mean(a)<span class="op">;</span> sa <span class="op">=</span> np.std(a,ddof<span class="op">=</span><span class="dv">1</span>)
mb <span class="op">=</span> np.mean(b)<span class="op">;</span> sb <span class="op">=</span> np.std(b,ddof<span class="op">=</span><span class="dv">1</span>)

<span class="im">from</span> scipy.stats.distributions <span class="im">import</span> norm
sw <span class="op">=</span> np.sqrt(sa<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="bu">len</span>(a) <span class="op">-</span> sb<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="bu">len</span>(b))

<span class="bu">print</span> (mb<span class="op">-</span>ma) <span class="op">+</span> np.array([<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>]) <span class="op">*</span> norm.ppf(<span class="fl">0.975</span>)<span class="op">*</span>sw</code></pre></div>
<pre><code>[ 0.53624225  2.09983618]</code></pre>
<p>Yüzde 95 güven aralığı 0 değerini içermediği için nüfus ortalamalarının birbirinden farklı olduğu sonucuna varıyoruz.</p>
<p>Verinin Yüzde Kaçı, Ortalama</p>
<p>Verinin yüzde 68'inin hangi aralık olduğu hesabı biraz farklı, ve daha basit. Mesela kafatası ölçümü için</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span> (np.array([dfetr.mean() <span class="op">-</span> dfetr.std(),
                 dfetr.mean() <span class="op">+</span> dfetr.std()]).T)</code></pre></div>
<p>Yani ortalam etrafında sağda ve solda tek standart sapmayla belirli bölge, bir Normal dağılımın yüzde 68'ine tekabül eder, ve bir veri Normal şekilde dağılmış ise, o verinin yüzde 68'inin hangi aralıkta olduğu bu şekilde hesaplanabilir.</p>
<pre><code>[[137.80833099 149.80612685]]</code></pre>
<div class="figure">
<img src="areanorm2.jpg" />

</div>
<p>Yüzde 95 hesabı için sağda ve solda iki standart sapmaya bakmak gerekir,</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span> (np.array([dfetr.mean() <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>dfetr.std(),
                 dfetr.mean() <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>dfetr.std()]).T)</code></pre></div>
<pre><code>[[131.80943306 155.80502478]]</code></pre>
<p>Peki yüzde 68, yüzde 95, gibi değerlerin standart sapma ile bağlantısının nereden biliyoruz? Düşünelim, her normal dağılım standart normal dağılıma indirgenebilir, ve standart normal dağılım <span class="math inline">\(N(0,1)\)</span>'dir, yani ortalaması 0 standart sapması 1. O zaman bu dağılımın, sıfır etrafında -1 ve +1 sınırları içindeki alan nedir hesabı basit kumulatif yoğunluk ile yapılabilir,</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> scipy.stats.distributions <span class="im">import</span> norm
<span class="bu">print</span> (norm.cdf(<span class="dv">1</span>)<span class="op">-</span>norm.cdf(<span class="op">-</span><span class="dv">1</span>)) <span class="co"># tek standart sapma</span>
<span class="bu">print</span> (norm.cdf(<span class="dv">2</span>)<span class="op">-</span>norm.cdf(<span class="op">-</span><span class="dv">2</span>)) <span class="co"># iki standart sapma</span></code></pre></div>
<pre><code>0.6826894921370859
0.9544997361036416</code></pre>
<p>Her dağılımın tamamının alanı bilindiği gibi 1, bu sebeple üstteki rakamlar bir yüzde olarak algılanabilir.</p>
<p>Kaynaklar</p>
<p>[1] Larsen, <em>Introduction to Mathematical Statistics and Its Applications</em></p>
<p>[2] Runger, <em>Applied Statistics and Probability for Engineers</em></p>
<p>[3] Dekker, <em>Probability and Statistical Inference</em></p>
<p>
  <a href="..">Yukarı</a>
</p>
</body>
</html>
