<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"], cancelto: ["Extension","cancel"]
      });
    });
    </script>  
   
  <title>Balonlar Ne Zaman Patlar?</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"
  type="text/javascript"></script>
</head>
<body>
<div id="header">
</div>
<h1 id="balonlar-ne-zaman-patlar">Balonlar Ne Zaman Patlar?</h1>
<p>Ekonomik krizlerin finans bağlamında kriz öncesi piyasalarda balon
oluşturduğu iddia edilir; mesela ABD’nin 1929, 1987 krizleri,
borsalardaki aşırı çıkışlar ardından düşüş ile başlamıştır, en son 2008
krizi öncesi emlak piyasasında balon oluşmuştur. Aynı dinamik tek bir
sektör endeksi, ya da tek senet bazında da görülebilmektedir. Demek ki
bu tür dinamiği anlayabilmek, tanıyabilmek, hatta nihai gidişatını
tahmin edebilmek yatırımcı için değerli bir yetenek olabilir.</p>
<p>Bu alanda Didier Sornette’in araştırmaları var [1,2], ona göre
balonlar fiyat zaman serisindeki artışın üstel artışı (exponential
increase) bile geçip süper üstel artış haline gelmesi durumudur. Bu
gidişat borsacıların, finansçılar, finans merkezlerinin birbiri ile çok
yönlü etkileşimi sonucunda oluşur, ve nihai bir patlama noktası vardır.
Sornette modeline deprem tahmin etme amacı ile başlamıştır, ardından
aynı yaklaşımı finans balonlarına da uygulayabileceğini
farketmiştir.</p>
<p>Model alttaki formüldür:</p>
<p><span class="math display">\[ \ln(p(t)) = A + B(t_c - t)^\beta
\big[ 1 + C \cos (\omega \ln(t_c-t) + \phi )  \big]
\qquad (1)
\]</span></p>
<p>Türetilmesiyle ilgili detaylar ve referanslar yazının sonunda
bulunabilir.</p>
<p>Formülü kullanmak için onu bilinen krizlerden önce elde olan veriye
uyduracağız. Normal şartlarda yapılacak budur, bir varlığın, endeksin
gidişatının balon olup olmadığı, eğer balon ise ne zaman patlayabileceği
merak konusudur. Örnek olarak 1929 ve 1987 krizlerini seçtik.</p>
<p>Ekim 1929 krizi Amerika’da “Büyük Depresyon’’ adı verilen dönemin
başlangıcıydı, ve kriz öncesi Dow Jones (DJIA) endeksinde müthiş bir
artış ardından düşüş gerçekleşti.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.tsa.stattools <span class="im">as</span> st</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd, zipfile</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> zipfile.ZipFile(<span class="st">&#39;data.zip&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    dfj <span class="op">=</span>  pd.read_csv(z.<span class="bu">open</span>(<span class="st">&#39;djia.csv&#39;</span>),index_col<span class="op">=</span><span class="st">&#39;Date&#39;</span>,parse_dates<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    dfs <span class="op">=</span>  pd.read_csv(z.<span class="bu">open</span>(<span class="st">&#39;sp500.csv&#39;</span>),index_col<span class="op">=</span><span class="st">&#39;Date&#39;</span>,parse_dates<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    dfi <span class="op">=</span>  pd.read_csv(z.<span class="bu">open</span>(<span class="st">&#39;ibb.csv&#39;</span>),index_col<span class="op">=</span><span class="st">&#39;Date&#39;</span>,parse_dates<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dfj[<span class="st">&#39;Adj Close&#39;</span>].plot()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plt.plot()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">&#39;tser_bubble_01.png&#39;</span>)</span></code></pre></div>
<p><img src="tser_bubble_01.png" /></p>
<p>Acaba DJIA bu evrede bir balon muydu? Sornette’in denklemini kriz
öncesi veriye uyduralım,</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lmfit <span class="im">import</span> Parameters, minimize</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lmfit.printfuncs <span class="im">import</span> report_fit</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_fit(<span class="bu">min</span>, <span class="bu">max</span>, init):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    fit_params <span class="op">=</span> Parameters()</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    fit_params.add(<span class="st">&#39;tc&#39;</span>, value<span class="op">=</span>init, <span class="bu">max</span><span class="op">=</span><span class="bu">max</span>, <span class="bu">min</span><span class="op">=</span><span class="bu">min</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    fit_params.add(<span class="st">&#39;A&#39;</span>, value<span class="op">=</span><span class="fl">2.0</span>, <span class="bu">max</span><span class="op">=</span><span class="fl">10.0</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    fit_params.add(<span class="st">&#39;m&#39;</span>, value<span class="op">=</span><span class="fl">0.5</span>, <span class="bu">max</span><span class="op">=</span><span class="fl">1.0</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">0.01</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    fit_params.add(<span class="st">&#39;C&#39;</span>, value<span class="op">=</span><span class="fl">0.0</span>, <span class="bu">max</span><span class="op">=</span><span class="fl">2.0</span>, <span class="bu">min</span><span class="op">=-</span><span class="dv">2</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    fit_params.add(<span class="st">&#39;beta&#39;</span>, value<span class="op">=</span><span class="fl">0.5</span>, <span class="bu">max</span><span class="op">=</span><span class="fl">1.0</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    fit_params.add(<span class="st">&#39;omega&#39;</span>, value<span class="op">=</span><span class="fl">20.</span>, <span class="bu">max</span><span class="op">=</span><span class="fl">40.0</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    fit_params.add(<span class="st">&#39;phi&#39;</span>, value<span class="op">=</span>np.pi, <span class="bu">max</span><span class="op">=</span><span class="dv">2</span><span class="op">*</span>np.pi, <span class="bu">min</span><span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fit_params</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(pars,x):</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    tc <span class="op">=</span> pars[<span class="st">&#39;tc&#39;</span>].value</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> pars[<span class="st">&#39;A&#39;</span>].value</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> pars[<span class="st">&#39;m&#39;</span>].value</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> pars[<span class="st">&#39;C&#39;</span>].value</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> pars[<span class="st">&#39;beta&#39;</span>].value</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    omega <span class="op">=</span> pars[<span class="st">&#39;omega&#39;</span>].value</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    phi <span class="op">=</span> pars[<span class="st">&#39;phi&#39;</span>].value</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    tmp1 <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> C<span class="op">*</span>np.cos(omega<span class="op">*</span>np.log(tc<span class="op">-</span>x) <span class="op">+</span> phi))</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> A <span class="op">-</span> ((m<span class="op">*</span>((tc<span class="op">-</span>x)<span class="op">**</span>beta))<span class="op">*</span>tmp1)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> residual(pars,y,t):</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y<span class="op">-</span>f(pars,t)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>fit_params <span class="op">=</span> init_fit(<span class="fl">1922.0</span>,<span class="fl">1940.</span>,<span class="dv">1939</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>dfj <span class="op">=</span> dfj[(dfj.index <span class="op">&gt;=</span> <span class="st">&#39;1922-01-01&#39;</span>)<span class="op">&amp;</span>(dfj.index <span class="op">&lt;=</span> <span class="st">&#39;1929-01-01&#39;</span>)]</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>dfj[<span class="st">&#39;DecDate&#39;</span>] <span class="op">=</span> np.linspace(<span class="dv">1922</span>,<span class="dv">1929</span>,<span class="bu">len</span>(dfj))</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.log(dfj[<span class="st">&#39;Adj Close&#39;</span>])</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> dfj[<span class="st">&#39;DecDate&#39;</span>]</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> minimize(residual, fit_params, args<span class="op">=</span>(y,t,))</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>report_fit(fit_params)</span></code></pre></div>
<pre><code>[[Variables]]
    tc:      1930.26611 +/- 0.060428 (0.00%) (init= 1939)
    A:       6.06304875 +/- 0.043302 (0.71%) (init= 2)
    m:       0.46154101 +/- 0.027743 (6.01%) (init= 0.5)
    C:       0.07785667 +/- 0.003250 (4.17%) (init= 0)
    beta:    0.62152034 +/- 0.019028 (3.06%) (init= 0.5)
    omega:   10.7292149 +/- 0.176101 (1.64%) (init= 20)
    phi:     6.28318123 +/- 6.869443 (109.33%) (init= 3.141593)
[[Correlations]] (unreported correlations are &lt;  0.100)
    C(omega, phi)                =  0.995 
    C(m, beta)                   = -0.994 
    C(tc, phi)                   =  0.982 
    C(tc, omega)                 =  0.963 
    C(A, m)                      =  0.960 
    C(A, beta)                   = -0.925 
    C(m, C)                      = -0.918 
    C(A, C)                      = -0.917 
    C(C, beta)                   =  0.903 
    C(tc, A)                     =  0.759 
    C(A, phi)                    =  0.726 
    C(A, omega)                  =  0.697 
    C(tc, C)                     = -0.623 
    C(C, phi)                    = -0.589 
    C(C, omega)                  = -0.559 
    C(tc, m)                     =  0.553 
    C(m, phi)                    =  0.518 
    C(m, omega)                  =  0.489 
    C(tc, beta)                  = -0.470 
    C(beta, phi)                 = -0.434 
    C(beta, omega)               = -0.404 </code></pre>
<p>Formül yılı ondalık yıl (decimal date) formatında istiyor, bu sebeple
bazı ek işlemler yapıldı.</p>
<p>Uyumdan gelen sonuç balon patlama anı <span
class="math inline">\(t_c\)</span> olarak 1930 başını verdi. Ve kriz
1929 sonunda gerçekleşti. İyi bir hesap. Dikkat, hesap için 1929 yılının
verisini bile almadık ve 1929 sonu 1930 başını elde ettik. Acaba uyum
istatiksel olarak ne kadar iyi? Cevap için uyumdan gelen artıklara
bakabiliriz, normal regresyonda artıkların gürültü, yani Gaussian
dağılıma sahip olmasını kontrol ediyorduk, zaman serisi uyumu için
artıkların ortalamaya-dönüşe (mean-reversion) sahip olup olmadığını
kontrol edebiliriz. Bunun için ADF testimiz var,</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> <span class="bu">list</span>(st.adfuller(out.residual,maxlag<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> res[<span class="dv">0</span>], <span class="st">&#39;%1,%5,%10&#39;</span>, res[<span class="dv">4</span>][<span class="st">&#39;1%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;5%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;10%&#39;</span>]</span></code></pre></div>
<pre><code>-3.94947024619 %1,%5,%10 -3.43409223882 -2.86319299 -2.56765000294</code></pre>
<p>Test artıkların yüzde 99 ihtimalle ortalamaya dönüşe sahip olduğunu
söylüyor.</p>
<p>Uydurulan fonksiyonu veriyle beraber gösterelim,</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dfj[<span class="st">&#39;Sornette&#39;</span>] <span class="op">=</span> np.exp(f(fit_params, dfj.DecDate))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dfj[[<span class="st">&#39;Adj Close&#39;</span>,<span class="st">&#39;Sornette&#39;</span>]].plot()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">&#39;tser_bubble_04.png&#39;</span>)</span></code></pre></div>
<p><img src="tser_bubble_04.png" /></p>
<p>Uyum oldukça iyi. Acaba balon patlama sorusunu daha az veriyle
sorsaydık ne olurdu? Yani, acaba, eldeki verinin iki senesini daha
silsek, yani aşırı yükselişin olmadığı zamandaki veriyle bir daha hesap
yapsak ne cevap alırdık? Modele göre aynı cevabı almamamız gerekir,
çünkü formül aşırı çıkışları yakalıyor, ve DJIA’in kriz öncesi son
anlarında aşırı çıkış vardı.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fit_params2 <span class="op">=</span> init_fit(<span class="fl">1922.0</span>,<span class="fl">1940.</span>,<span class="fl">1939.</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dfj2 <span class="op">=</span> dfj[:<span class="op">-</span><span class="dv">600</span>] <span class="co"># son iki sene verisini attik</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> np.log(dfj2[<span class="st">&#39;Adj Close&#39;</span>])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> dfj2[<span class="st">&#39;DecDate&#39;</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>out2 <span class="op">=</span> minimize(residual, fit_params2, args<span class="op">=</span>(y2,t2,))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>res2 <span class="op">=</span> <span class="bu">list</span>(st.adfuller(out2.residual,maxlag<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> res2[<span class="dv">0</span>], <span class="st">&#39;%1,%5,%10&#39;</span>, res[<span class="dv">4</span>][<span class="st">&#39;1%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;5%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;10%&#39;</span>]</span></code></pre></div>
<pre><code>-2.01491805971 %1,%5,%10 -3.43409223882 -2.86319299 -2.56765000294</code></pre>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> fit_params2[<span class="st">&#39;tc&#39;</span>].value </span></code></pre></div>
<pre><code>1926.91504363</code></pre>
<p>Testler yüzde 90 aralığına bile yaklaşamadı. Uyum başarılı değil.</p>
<p>Kara Pazartesi (Black Monday)</p>
<p>Ekim 19, 1987’da S&amp;P 500 büyük bir düşüş yaşadı ve bu gün tarihe
Kara Pazartesi olarak geçti. Büyük düşüş öncesi oluşan çıkışın balon
olduğu iddia edilmektedir.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dfs[<span class="st">&#39;Adj Close&#39;</span>].plot()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">&#39;tser_bubble_02.png&#39;</span>)</span></code></pre></div>
<p><img src="tser_bubble_02.png" /></p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> dfs[(dfs.index <span class="op">&lt;</span> <span class="st">&#39;1987-10-18&#39;</span>)] <span class="co"># kara ptesi oncesini al</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>beg_date <span class="op">=</span> dfs.head(<span class="dv">1</span>).index[<span class="dv">0</span>].timetuple()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>beg_date_dec <span class="op">=</span> beg_date.tm_year <span class="op">+</span> (beg_date.tm_yday <span class="op">/</span> <span class="fl">367.</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> dfs.tail(<span class="dv">1</span>).index[<span class="dv">0</span>].timetuple()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>end_date_dec <span class="op">=</span> end_date.tm_year <span class="op">+</span> (end_date.tm_yday <span class="op">/</span> <span class="fl">367.</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>dfs[<span class="st">&#39;DecDate&#39;</span>] <span class="op">=</span> np.linspace(beg_date_dec,end_date_dec,<span class="bu">len</span>(dfs))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>fit_params3 <span class="op">=</span> init_fit(<span class="fl">1970.</span>,<span class="fl">1995.</span>,<span class="fl">1989.</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> np.log(dfs[<span class="st">&#39;Adj Close&#39;</span>])</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>t3 <span class="op">=</span> dfs[<span class="st">&#39;DecDate&#39;</span>]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>out3 <span class="op">=</span> minimize(residual, fit_params3, args<span class="op">=</span>(y3,t3,))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>report_fit(fit_params3)</span></code></pre></div>
<pre><code>[[Variables]]
    tc:      1987.78746 +/- 0.001713 (0.00%) (init= 1989)
    A:       2.16393842 +/- 0.780555 (36.07%) (init= 2)
    m:       0.44165592 +/- 0.757581 (171.53%) (init= 0.5)
    C:       0.00092504 +/- 0.121291 (13112.07%) (init= 0)
    beta:    0.45100463 +/- 0.517380 (114.72%) (init= 0.5)
    omega:   20.2695125 +/- 239.2351 (1180.27%) (init= 20)
    phi:     2.80991123 +/- 440.6670 (15682.60%) (init= 3.141593)
[[Correlations]] (unreported correlations are &lt;  0.100)
    C(m, beta)                   = -0.988 
    C(A, m)                      =  0.986 
    C(omega, phi)                = -0.958 
    C(A, beta)                   = -0.951 
    C(tc, A)                     =  0.209 
    C(tc, m)                     =  0.206 
    C(tc, beta)                  = -0.198 
    C(C, beta)                   =  0.117 </code></pre>
<p>Cevap kabaca Kara Pazartesi anını yakaladı! Artıkları kontrol
edelim,</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>res3 <span class="op">=</span> <span class="bu">list</span>(st.adfuller(out3.residual,maxlag<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> res3[<span class="dv">0</span>], <span class="st">&#39;%1,%5,%10&#39;</span>, res[<span class="dv">4</span>][<span class="st">&#39;1%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;5%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;10%&#39;</span>]</span></code></pre></div>
<pre><code>-2.31790207914 %1,%5,%10 -3.43409223882 -2.86319299 -2.56765000294</code></pre>
<p>Tam yüzde 90-95 aralığına düşmedi, fakat çok uzak ta değil. Bu uyumun
fena olduğu söylenemez.</p>
<p>Biyoteknoloji</p>
<p>Daha yakın zamandan bir örnek verelim. ABD biyoteknoloji hisselerinde
abartılı bir artış olduğu uzun zamandır söylenmekteydi. Biyoteknoloji
sektörünü temsil eden bir ETF olan IBB’nin grafiği alttadır.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dfi[<span class="st">&#39;Adj Close&#39;</span>].plot()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">&#39;tser_bubble_03.png&#39;</span>)</span></code></pre></div>
<p><img src="tser_bubble_03.png" /></p>
<p>Biyoteknoloji balonu 2015’in ikinci bölümünde patladı ve sert bir
düşüş yaşandı. Acaba tekniğimiz bu düşüşü yakalayabilecek mi?</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dfi <span class="op">=</span> dfi[(dfi.index <span class="op">&lt;</span> <span class="st">&#39;2015-07-01&#39;</span>)] </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>beg_date <span class="op">=</span> dfi.head(<span class="dv">1</span>).index[<span class="dv">0</span>].timetuple()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>beg_date_dec <span class="op">=</span> beg_date.tm_year <span class="op">+</span> (beg_date.tm_yday <span class="op">/</span> <span class="fl">367.</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> dfi.tail(<span class="dv">1</span>).index[<span class="dv">0</span>].timetuple()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>end_date_dec <span class="op">=</span> end_date.tm_year <span class="op">+</span> (end_date.tm_yday <span class="op">/</span> <span class="fl">367.</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>dfi[<span class="st">&#39;DecDate&#39;</span>] <span class="op">=</span> np.linspace(beg_date_dec,end_date_dec,<span class="bu">len</span>(dfi))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>fit_params4 <span class="op">=</span> init_fit(<span class="fl">2012.</span>,<span class="fl">2018.</span>,<span class="fl">2017.</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>y4 <span class="op">=</span> np.log(dfi[<span class="st">&#39;Adj Close&#39;</span>])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>t4 <span class="op">=</span> dfi[<span class="st">&#39;DecDate&#39;</span>]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>out4 <span class="op">=</span> minimize(residual, fit_params4, args<span class="op">=</span>(y4,t4,))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> fit_params4[<span class="st">&#39;tc&#39;</span>].value </span></code></pre></div>
<pre><code>2015.51052262</code></pre>
<p>Sonuç olarak 2015 ortası verildi. Uyum nasıl?</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>res4 <span class="op">=</span> <span class="bu">list</span>(st.adfuller(out4.residual,maxlag<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> res4[<span class="dv">0</span>], <span class="st">&#39;%1,%5,%10&#39;</span>, res[<span class="dv">4</span>][<span class="st">&#39;1%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;5%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;10%&#39;</span>]</span></code></pre></div>
<pre><code>-2.34444994145 %1,%5,%10 -3.43409223882 -2.86319299 -2.56765000294</code></pre>
<p>Test sonucu 90-95 aralığına yakın, uyum fena değil.</p>
<p>Bu teknik borsada alım/satım stratejisi bağlamında otomize olarak
kullanılabilir, ya da belli bazı hisselerden ne zaman uzak durulacağı
konusunda bir alarm vermek için faydalı olabilir.</p>
<p>Türetmek</p>
<p>Sornette’in modelinin başlangıcı bir zaman serisindeki artışının
üstel (exponential) hızı geçtiği zaman sonlu-anda (finite-time) bir
eşsizlik (singularity) çıktığı iddiası [1,4]. Eşsizlik konusunu {}
notlarında işledik; eşsiz nokta bir fonksiyonun analitikliği kaybettiği
yerdir. Peki modelde eşsizliğin ortaya çıkması gerçek hayatta illa bunun
olacağı anlamına geliyor mu? İlginç bir şekilde eğer matematiksel model
sağlam ise eşsizliğin tahmin edildiği yerde hakikaten bu durum ortaya
çıkıyor, mesela izafiyet kuramının matematiği eşsiz noktaların varlığını
tahmin eder, ve hakikaten de tahmin edildiği şekilde uzayda bu
noktalarda kara deliklerin olduğu ispatlanmıştır. Aynı şekilde bir
materyelin kırılması / parçalanması matematiksel modelin eşsizlik
noktasında olur, ve deneylerde bu anda materyel kırılması
gözlenmiştir.</p>
<p>Sornette’e göre nüfus artışı, bir ekonominin ürettiği değeri temsil
eden gayrısafi yurtiçi hasıla (gross domestic product -GDP-) artışı
rakamlarına dünya bazında bakarsak üstel üstü artışları görebiliyoruz,
ve aynen materyel kırılmasında olduğu gibi modelin eşsizlik tahmin
ettiği yeri “bir fazın bittiği an’’ olarak görürsek, bu nokta bir tür
sürdüremezliğin geldiği an olacaktır, ve tabiri caizse”inceldiği yerden
kopma’’ noktasıdır, ve bunun ötesinde mesela ne daha fazla nüfus artışı,
ne de ekonomik büyüme mümkün değildir. En azından mevcut çevre, mevcut
ölçümler üzerinden ekonomik büyüme dediğimiz şey olmayacaktır.</p>
<p>Sonlu an eşsizliğine erişmek için mesela normal nüfus artışı
modelinden başlayalım, nüfusu modellemenin en iyi bilinen yolu Lojistik
Denklemdir, bkz [6], [7], [8]. Model şöyledir;</p>
<p><span class="math display">\[ \frac{dp}{dt} = rp(t) [ K - p(t) ]
\]</span></p>
<p>Lojistik modelde bir taşıma kapasitesi <span
class="math inline">\(K\)</span> vardır, ve bu kapasitenin daha
fazlasını çevre koşullarının taşıması mümkün değildir. Fakat [4]’teki
referanslara göre şu iddia edilmektedir; <span
class="math inline">\(p(t)\)</span> ile birlikte <span
class="math inline">\(K\)</span> de artmaktadır, çünkü araçlarımızı daha
iyi kullanıyoruz, sürekli keşifler yapıyoruz, ilaçlar, gübre çeşitleri,
vs. ve yeni bölgelere yayılıyoruz, yani sürekli taşıma kapasitesini
aşıyoruz. Bu durumda, yani <span class="math inline">\(K &gt;
p(t)\)</span>’in olduğu durumda lojistik denklemini çözümü patlar, yani
uzaklaşır (divergent) hale gelir ve sonsuza gider. Bu gidiş süresi,
eşsizlik öncesi varışta giden zaman sonludur, yani belli bir büyüklüğü
vardır.</p>
<p>Bu durumda denkleme artık hiçbir etkisi olmayan <span
class="math inline">\(-p(t)\)</span> denklemden çıkartılabilir, ve o
zaman geri kalanlar <span class="math inline">\(\delta &gt; 1\)</span>
olacak şekilde <span class="math inline">\(K \propto
p^{1+\delta}\)</span> kabul edilebilir, yani <span
class="math inline">\(K\)</span>’nin kendisi <span
class="math inline">\(p\)</span>’ye oranla büyüyor ve arada bir üstel
kanun (power law) ilişkisi vardır. Şimdi aynı formülü şu şekilde
yazarız,</p>
<p><span class="math display">\[ \frac{dp}{dt} = r [p(t)]^{1+\delta}
\]</span></p>
<p>ki bu formüle göre artış oranı <span class="math inline">\(r
[p(t)]^{1+\delta}\)</span> olarak hızlanmaktadır. Çözelim,</p>
<p><span class="math display">\[ \int \frac{dp}{p(t)^{1+\delta}} = \int
rt\]</span></p>
<p><span class="math display">\[ \int p(t)^{-1-\delta} \mathrm{d} p = rt
+ C \]</span></p>
<p><span class="math inline">\(t_c\)</span>’ye (ki bir sabit) erişmek
amaçlı olarak <span class="math inline">\(C = -rt_c\)</span>
tanımlayalım,</p>
<p><span class="math display">\[ \frac{p(t)^{-\delta}}{-\delta} = rt -
rt_c \]</span></p>
<p><span class="math display">\[ p(t)^{-\delta}= -\delta r(t - t_c)
\]</span></p>
<p><span class="math inline">\(t-t_c = -(t_c-t)\)</span> olduğu için
parantez içindeki çıkartma işlemi şu hale gelir,</p>
<p><span class="math display">\[ p(t)^{-\delta}= \delta r(t_c - t)
\]</span></p>
<p>İstediğimiz forma yaklaştık çünkü <span
class="math inline">\(t_c\)</span>’yi eşsizlik anı olarak hesaplamak
istiyoruz, ve <span class="math inline">\(t\)</span> bu andan önceki
zamanı temsil ediyor olmalı. Şimdi <span class="math inline">\(\alpha =
-\frac{1}{\delta}\)</span> tanımlayalım, ve eşitliğin her iki tarafının
<span class="math inline">\(\alpha\)</span> üstünü alalım,</p>
<p><span class="math display">\[ (p(t)^{-\delta})^\alpha= (\delta r
)^\alpha (t_c - t)^\alpha \]</span></p>
<p>Eğer <span class="math inline">\(p(0) = p_0 = (\delta r
)^\alpha\)</span> kabul edersek, eşitliğin sol tarafını
basitleştirince,</p>
<p><span class="math display">\[ p(t) = p_0 (t_c - t)^\alpha
\]</span></p>
<p>elde ederiz, ki bu denklemin <span class="math inline">\(t_c\)</span>
anında eşsizliği vardır.</p>
<p>Şimdi bu basit modeli veri üzerinde test edelim. Elimizde bir milyon
yıl geriye giden nüfus modeli var [3], sadece 0’inci yıl ile 1989
arasını alalım, ve modeli uyduralım ve bilinmeyen parametreleri
hesaplamaya uğraşalım. Veriyi uydurma amaçlı olarak şu formül daha
kullanışlı olabilir,</p>
<p><span class="math display">\[
p(t) = A + B(t_c - t)^z
\qquad (2)
\]</span></p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>dfpop <span class="op">=</span> pd.read_csv(<span class="st">&#39;wpop.csv&#39;</span>,comment<span class="op">=</span><span class="st">&#39;#&#39;</span>,sep<span class="op">=</span><span class="st">&#39;\s&#39;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>dfpop <span class="op">=</span> dfpop[(dfpop[<span class="st">&#39;Year&#39;</span>] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="op">&amp;</span> (dfpop[<span class="st">&#39;Year&#39;</span>] <span class="op">&lt;=</span> <span class="dv">1998</span>)]</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.tsa.stattools <span class="im">as</span> st</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lmfit <span class="im">import</span> Parameters, minimize</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lmfit.printfuncs <span class="im">import</span> report_fit</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(pars,t):</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    tc <span class="op">=</span> pars[<span class="st">&#39;tc&#39;</span>].value</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> pars[<span class="st">&#39;z&#39;</span>].value</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> pars[<span class="st">&#39;A&#39;</span>].value</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> pars[<span class="st">&#39;B&#39;</span>].value</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> A <span class="op">+</span> B<span class="op">*</span>((tc <span class="op">-</span> t)<span class="op">**</span>z)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> residual(pars,y,t):</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y<span class="op">-</span>f(pars,t)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fit_params <span class="op">=</span> Parameters()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fit_params.add(<span class="st">&#39;tc&#39;</span>, value<span class="op">=</span><span class="fl">2100.0</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">2000.</span>,<span class="bu">max</span><span class="op">=</span><span class="fl">2400.</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fit_params.add(<span class="st">&#39;z&#39;</span>, value<span class="op">=-</span><span class="fl">1.</span>, <span class="bu">min</span><span class="op">=-</span><span class="fl">5.0</span>,<span class="bu">max</span><span class="op">=</span><span class="fl">5.0</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>fit_params.add(<span class="st">&#39;A&#39;</span>, value<span class="op">=</span><span class="fl">0.</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">0.0</span>, <span class="bu">max</span><span class="op">=</span><span class="fl">10.0</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>fit_params.add(<span class="st">&#39;B&#39;</span>, value<span class="op">=</span><span class="dv">20</span><span class="op">*</span><span class="fl">1000.</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">0.0</span>,<span class="bu">max</span><span class="op">=</span><span class="dv">30</span><span class="op">*</span><span class="fl">1000.0</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.log(np.array(dfpop.Population.astype(<span class="bu">float</span>)))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.array(dfpop.Year.astype(<span class="bu">float</span>))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> minimize(residual, fit_params, args<span class="op">=</span>(y,t,))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>report_fit(fit_params)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> <span class="bu">list</span>(st.adfuller(out.residual,maxlag<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">&#39;ADF testi&#39;</span>, res[<span class="dv">0</span>], <span class="st">&#39;%1,%5,%10&#39;</span>, res[<span class="dv">4</span>][<span class="st">&#39;1%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;5%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;10%&#39;</span>]</span></code></pre></div>
<pre><code>[[Variables]]
    tc:   2047.37659 +/- 10.86346 (0.53%) (init= 2100)
    z:   -0.24662286 +/- 0.062236 (25.24%) (init=-1)
    A:    2.72771567 +/- 0.669841 (24.56%) (init= 0)
    B:    15.9169748 +/- 2.943371 (18.49%) (init= 20000)
[[Correlations]] (unreported correlations are &lt;  0.100)
    C(z, A)                      = -0.996 
    C(z, B)                      = -0.992 
    C(tc, B)                     =  0.981 
    C(A, B)                      =  0.977 
    C(tc, z)                     = -0.954 
    C(tc, A)                     =  0.926 
ADF testi -3.14127355675 %1,%5,%10 -3.61550910118 -2.94126235749 -2.60919950139</code></pre>
<p>Sonuç +- 10 sene hata payı ile 2047 senesi çıktı. Artıklar üzerinde
ADF testi yaptık, yüzde 95 kesinliğinde artıkların ortalamaya dönüş
özelliğine sahip olduğunu görüyoruz. Model uyumu iyi demek.</p>
<p>GDP verisine bakalım,</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>dfgdp <span class="op">=</span> pd.read_csv(<span class="st">&#39;wgdpreal.csv&#39;</span>,comment<span class="op">=</span><span class="st">&#39;#&#39;</span>,sep<span class="op">=</span><span class="st">&#39;\s&#39;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>dfgdp <span class="op">=</span> dfgdp[(dfgdp[<span class="st">&#39;Year&#39;</span>] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="op">&amp;</span> (dfgdp[<span class="st">&#39;Year&#39;</span>] <span class="op">&lt;=</span> <span class="dv">1998</span>)]</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fit_params <span class="op">=</span> Parameters()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fit_params.add(<span class="st">&#39;tc&#39;</span>, value<span class="op">=</span><span class="fl">2100.0</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">2000.</span>,<span class="bu">max</span><span class="op">=</span><span class="fl">2400.</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>fit_params.add(<span class="st">&#39;z&#39;</span>, value<span class="op">=-</span><span class="fl">1.</span>, <span class="bu">min</span><span class="op">=-</span><span class="fl">5.0</span>,<span class="bu">max</span><span class="op">=</span><span class="fl">5.0</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>fit_params.add(<span class="st">&#39;A&#39;</span>, value<span class="op">=</span><span class="fl">0.</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">0.0</span>, <span class="bu">max</span><span class="op">=</span><span class="fl">10.0</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>fit_params.add(<span class="st">&#39;B&#39;</span>, value<span class="op">=</span><span class="dv">20</span><span class="op">*</span><span class="fl">1000.</span>, <span class="bu">min</span><span class="op">=</span><span class="fl">0.0</span>,<span class="bu">max</span><span class="op">=</span><span class="dv">30</span><span class="op">*</span><span class="fl">1000.0</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.log(np.array(dfgdp.GDPPC.astype(<span class="bu">float</span>)))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.array(dfgdp.Year.astype(<span class="bu">float</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> minimize(residual, fit_params, args<span class="op">=</span>(y,t,))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>report_fit(fit_params)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> <span class="bu">list</span>(st.adfuller(out.residual,maxlag<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">&#39;ADF testi&#39;</span>, res[<span class="dv">0</span>], <span class="st">&#39;%1-%10&#39;</span>, res[<span class="dv">4</span>][<span class="st">&#39;1%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;5%&#39;</span>], res[<span class="dv">4</span>][<span class="st">&#39;10%&#39;</span>]</span></code></pre></div>
<pre><code>[[Variables]]
    tc:   2148.16544 +/- 21.95284 (1.02%) (init= 2100)
    z:   -1.33135253 +/- 0.155306 (11.67%) (init=-1)
    A:    2.81936402 +/- 0.092028 (3.26%) (init= 0)
    B:    6344.88666 +/- 5.51e+03 (86.76%) (init= 20000)
[[Correlations]] (unreported correlations are &lt;  0.100)
    C(z, B)                      = -0.999 
    C(tc, B)                     =  0.987 
    C(tc, z)                     = -0.981 
    C(z, A)                      = -0.928 
    C(A, B)                      =  0.917 
    C(tc, A)                     =  0.861 
ADF testi -2.65894249385 %1-%10 -3.61550910118 -2.94126235749 -2.60919950139</code></pre>
<p>Burada +- 20 sene hata payıyla 2148 çıktı (daha var!), artıklar yine
ortalama dönüşe sahip. Bu demektir ki ekonomik büyüme, mevcut
gidişatıyla patlama yapacaktır ve kritik an bir tür faz sonu (end of a
regime) olarak addedilebilecektir. Mevcut şartlar altında bundan daha
fazlası mümkün değil.</p>
<p>Log Salınım (Log Oscillation)</p>
<p>[4,5]‘te bu modelin geliştirilerek (1) formülüne nasıl erişildiğinin
detayları bulunabilir. Hikayenin özü şöyle; materyel kırılması ve buna
benzer diğer doğal olaylarda eşsizlik anı öncesi log salınımlar olduğu
da görülmüştür. Bu salınımlara matematiksel olarak erişmek için (2)’deki
formüldeki <span class="math inline">\(z\)</span> üstelinin kompleks
sayı olmasına izin verilir, yani <span class="math inline">\(\beta +
i\omega\)</span> formunda olduğu farz edilir, ve bu şekilde türetime
devam edince ortaya (1)’deki log periyodik salınımlar çıkar. Detaylar
için [1,4]. Sornette bu salınım ekinin formülü “dekore’’ ettiğini
söylemektedir, güzel bir kelime seçilmiş, hakikaten bu salınımlar ana
formüle bir ek, onu”süslüyor’’, fakat tabii ki bu sayede eşsizlik
noktasını yakalamamız kolaylaşıyor çünkü uydurma rutinimiz artık
verideki bu salınımları da veride bulmaya uğraşıyor böylece aradığı tüm
parametrelerin kalitesi artmış oluyor.</p>
<p>Sornette bazı kaynaklarda bir değişik türetim şekli daha uyguluyor
[1,5]; buna göre <span class="math inline">\(p(t)\)</span> olarak
belirttiğimiz <span class="math inline">\(h(t)\)</span>, tehlike oranı
(hazard rate) olarak modellenir, ve fiyat serisi <span
class="math inline">\(p(t)\)</span> olarak rasgele calculus’tan
gelinerek modelleniyor, ve <span class="math inline">\(h(t)\)</span>,
<span class="math inline">\(p(t)\)</span>’ye sokuluyor, ve ortaya log
salınımlı model çıkıyor. Bu türetişin bazı ilginç bağlantıları var,
mesela tehlike oranının kimi aşırı, kimi az ama hepsi birbiriyle
etkileşimde olan borsacıların birbirini taklit etmesi yüzünden <span
class="math inline">\(h(t)\)</span>’nin arttığı modellenmekte, ki bu
artış ta bir üstel kanunu takip ediyor. Fizik ve sosyal modelde birbiri
ile aşırı etkileşim sürekli ortaya üstel kanun çıkartıyor, bunu
biliyoruz. Patlama anı ve öncesinde aslında ortada olan bir kaos değil,
kaos <em>yokluğu</em>. Bütüne bakıldığında biri rasgele bazen satan,
biri rasgele bazen alan borsacıların patlama anı öncesi birdenbire
düzenli bir şekilde hepsi <em>satıyor</em>.</p>
<p>Kaynaklar</p>
<p>[1] Sornette, <em>Why Stock Markets Crash</em></p>
<p>[2] Sornette, <em>How we can predict the next financial crisis</em>,
<a
href="https://www.youtube.com/watch?v=C_eFjLZqXt8">https://www.youtube.com/watch?v=C_eFjLZqXt8</a></p>
<p>[3] Long, <em>Estimates of World GDP, One Million B.C. -
Present</em></p>
<p>[4] Sornette, <em>Finite-time singularity in the dynamics of the
world population, economic and financial indices</em></p>
<p>[5] Geraskin, <em>Everything You Always Wanted to Know about Log
Periodic Power Laws for Bubble Modelling but Were Afraid to Ask</em></p>
<p>[6] Bayramlı, Diferansiyel Denklemler, <em>Matematiksel
Modelleme</em></p>
<p>[7] Bayramlı, Gayrı Lineer Dinamik ve Kaos, <em>Ders 1</em></p>
<p>[8] Bayramlı, Diferansiyel Denklemler, <em>Ders 5</em></p>
<p>
  <a href="..">Yukarı</a>
</p>
</body>
</html>
