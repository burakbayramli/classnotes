\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Ders 6

Özvektör formülüne tekrar bakalým

$$ Ay = \lambda y $$

Þimdi tüm özvektörler ayný anda tek bir matris içinde olacak þekilde
üstteki formülün her özvektör için iþleyecek ``kombine'' bir halini
yazabiliriz. $y_i$ vektörünün tüm bir kolonu kaplayacak þekilde matrise
yazýldýðýný düþünüyoruz. 

$$ 
A 
\left[\begin{array}{cccc}
\uparrow & \uparrow &  & \uparrow \\
y_1 & y_2 & ... & y_n \\
\downarrow & \downarrow &  & \downarrow 
\end{array}\right]
= 
\left[\begin{array}{cccc}
&&& \\
Ay_1 & Ay_2 & ... & Ay_n \\
&&& 
\end{array}\right]
$$

Buna göre üstteki eþitliðin saðýndaki çarpým da mantýklýdýr.Peki $Ay_i$
çarpýmý tanýdýk gelmiyor mu? Çarpým özvektör, özdeðer formülü. O zaman
$Ay_i = \lambda y_i$. Demek ki,

$$ 
\left[\begin{array}{cccc}
&&& \\
Ay_1 & Ay_2 & ... & Ay_n \\
&&& 
\end{array}\right]
= 
\left[\begin{array}{cccc}
&&& \\
\lambda_1y_1 & \lambda_2y_2 & ... & \lambda_ny_n \\
&&& 
\end{array}\right]
 $$

$\lambda$'larý dýþarý çekebiliriz. 

$$ 
= \left[\begin{array}{cccc}
&&& \\
y_1 & y_2 & ... & y_n \\
&&& 
\end{array}\right]
\left[\begin{array}{cccc}
\lambda_1 &&& \\
& .. && \\
&&& \lambda_n \\
\end{array}\right]
 $$

$\lambda$ matrisinde $\lambda$ olmayan yerler sýfýr deðerini
taþýyor. Özvektör matrisini $S$ olarak, çaprazýnda özdeðerleri taþýyan
matrisi $\Lambda$ olarak nitelersek

$$ AS = S\Lambda $$

Eðer üstteki $S$ (ya da herhangi bir) matrisinin tüm kolonlarý birbirinden
baðýmsýz ise $S$ tersine çevirelebilir (invertible) demektir. O zaman þunu
yapabiliriz:

$$ A = S \Lambda S^{-1} $$

Bu forma matrisin köþegenleþtirilmesi (diagonalization) deniyor. 

Biraz zihin egzersizi: $A^2$ ne olur? 

$$ A^2 = (S \Lambda S^{-1})(S \Lambda S^{-1}) $$

$$ = S \Lambda S^{-1}S \Lambda S^{-1} $$

ortadaki $S$ ve $S^{-1}$ birbirini iptal eder. 

$$ = S \Lambda^2 S^{-1} $$

Bu bana ne söylüyor? $A^2$'nin özvektörleri $A$ ile ayný, çünkü formülün
$S$ ve $S^{-1}$ içeren kýsmý deðiþmedi, özdeðerler ise $A$'nin
özdeðerlerinin karesi. Bu önceden bulduðumuz $A^2y = \lambda^2y$ sonucu 
ile uyuþuyor.

Peki, diyelim tersine çevirilebilir ise, $A^{-1}$ nedir? Ana formülden 
baþlayalým

$$ A = S \Lambda S^{-1} $$

Tersine çevirme iþlemi eþitliðin sað tarafýnda parantezin içinin sýrasýný
deðiþtirir, sonra tersine çevirir, $S^{-1}$ ile baþlarýz, onun tersi $S$,
vs, ve sonuç

$$ A^{-1} = S \Lambda^{-1}S^{-1} $$

Özvektörler matrislerinin yeri ve içeriði deðiþmedi. Deðiþik olan tek þey
$\Lambda^{-1}$ ki bu matris içinde $1/\lambda_1$, $1/\lambda_2$, .. gibi
deðerler olacak. Diðer bir açýdan kontrol edelim:

$$ Ay = \lambda y $$

$$ y = \lambda A^{-1} y $$

$$ \frac{1}{\lambda}y =  A^{-1} y $$

Bu üstteki sonuç ile ayný þeyi söylüyor. $A^{-1}$'in tersi ayný $y$
özvektör(ler)e sahip, ve solda olan özdeðer öncekine kýyasla $1/\lambda$
deðerinde. 

Tabii tüm bunlara baþlamadan önce ``$\lambda$'nin sýfýr olmadýðý
durumlarda'' demeliydim, çünkü bu sýfýrlýk durum bize $A$'nin tersine
çevirilir olmadýðý yönünde bir iþaret olurdu. Terminoloji olarak bir tane
bile sýfýr özdeðer $A$ eþsiz (singular) demektir, eðer hiçbiri sýfýr
deðilse $A$ tersine çevirilebilir demektir.

Bir simetrik $K$ matrisini ele alalým, simetrik olduðu için tüm özdeðerleri
reel sayýlar, ve özvektörleri birbirine dikgen (orthagonal). 

Dik yerine normalize edilmiþ de diyebilirdik, sayýsal paketler çoðunlukla
birimselleþtirilmiþ, yani uzunluðu 1 olan vektörler döndürür, ve
özdeðer/vektör ikilisi için zaten yön önemlidir, hem özdeðer hem özvektörü
2 ile çarpýp ayný þeyi elde edebiliriz mesela.

Uzunluktan bahsederken, onu daha önce $y_i^T \cdot y_j$ olarak gösterdik,
ki simetrik bir matrisin dik özdeðerleri için bu $y_i^T \cdot y_j = 0, \ i
\ne j$. Normalize edilmiþ bir özvektörün kendisi ile noktasal çarpýmý nedir? 
$y_i^T \cdot y_i = 1$ çünkü vektör birimsel, uzunluðu 1. Tüm
özdeðerleri içeren matris üzerinden bu hesabý yapabilir miyiz? Daha önce
yarattýðýmýz þu matris ile baþlayalým:

$$ 
\left[\begin{array}{cccc}
\uparrow & \uparrow &  & \uparrow \\
y_1 & y_2 & ... & y_n \\
\downarrow & \downarrow &  & \downarrow 
\end{array}\right]
$$

sol tarafýna devriðini (transpose) koyalým

$$ 
\left[\begin{array}{ccc}
\leftarrow & y_1^T & \rightarrow \\
 & ... & \\
\leftarrow & y_n^T & \rightarrow 
\end{array}\right]
\left[\begin{array}{cccc}
\uparrow & \uparrow &  & \uparrow \\
y_1 & y_2 & ... & y_n \\
\downarrow & \downarrow &  & \downarrow 
\end{array}\right]
$$

Bu çarpýmý yaparsak sonuç ne olacak? Mesela $y_1^T$ ile $y_1$ çarpýmý 1
deðerinde, $y_1^T$ ile diðer her çarpým sýfýr. Böyle gider. Ve sonuç olarak
çaprazýnda 1 diðer her yerinde 0 içeren birim (identity) matrisini elde
ederiz.

Üzerine basarak söyleyelim, bu simetrik matrisler için, çünkü diðer $A$
matrisleri için özvektörlerin hepsinin birbirine dik olmasýný
bekleyemeyiz. 

Devam edelim, o zaman üstteki hesabý kýsaca gösterirsek

$$ S^T S = I $$

Bu hakikaten çok önemli bir sonuç. 

Üsttekinin doðru olduðu durumlarda $S$ harfini deðiþtirirsek aslýnda daha iyi
olur böylece özvektör matrisinin bir simetrik $K$ matrisinden geldiðini
daha iyi görürüz. Bu durumlarda $Q$ harfini kullanalým. 

$Q$'ye bir ``dik matris'' te denebilir, çünkü $Q^TQ = I$. Bu ifadeye
bakarak baþka bir þey daha söyleyebiliriz, $Q$'yu baþka \textbf{ne} soldan
çarparsa sonuç birim matristir? $Q^{-1}$. O zaman $Q^T = Q^{-1}$ de
diyebiliriz.

Bir dik matris örneði görelim:

$$ 
\left[\begin{array}{cc}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta \\
\end{array}\right]
 $$

Ýlk kolona bakalým, uzunluðu hakikaten 1, çünkü $\cos \theta ^2 + \sin \theta
^2 = 1$. Diðer kolon da ona dik, 1. kolon ile çarpýlýnca sonuç sýfýr olacak. 

Not: Üstteki matrise ``$\theta$ kadar döndüren matris'' ismi de verilir,
eldeki bir $v$ vektörünü $Q$ ile çarpýmý, yani $Qv$, o vektörü uzunluðunu
deðiþtirmeden $\theta$ kadar döndürecektir.

Devam edelim

$$ K = S \Lambda S^{-1} $$

$S$ yerine $Q$ kullanmaya karar vermiþtik

$$  K = Q \Lambda Q^{-1} $$

O zaman, daha önceden gördüðümüz eþitlik üzerinden, 

$$  K = Q \Lambda Q^{T} $$

Þu güzelliðe bakýn. Buna mekanikte ana eksen teoremi (principal axis theorem),
matematikte spektral teoremi (spectral theorem), kuantum mekanikte
köþegenleþtirme (diagonalization) ismi verilir, her yerde ortaya çýkar, pek çok
þekilde kullanýlýr. Ne zaman elde bir simetrik matris var ise, o zaman üstteki
taným kullanýlabilir demektir.

$K$ matrisine geri dönelim. 

$$ 
K =
\left[\begin{array}{rrrrr}
2 & -1 &&& \\
-1 & \ddots & \ddots && \\
& \ddots &&& \\
&&&& \\
&&&& 
\end{array}\right]
 $$

Bu matris ikinci farklýlýklarý ayrýksal olarak temsil etmek için
kullanýlmýþtý, esnek çubuðu temsil ettiði zaman sabit / sabit problemini
çözüyordu. $K$ sürekli (continuous) baðlamda hangi diferansiyel
denklemi temsil edecektir? $-d^2y/dx^2$.  Özdeðer, özvektör olarak ise

$$ Ky = \lambda y $$

Þöyle bir geçiþ yapýlabilir

$$ -\frac{d^2y}{dx^2} = \lambda y(x) $$

Burada ilginç bir numara var: daha önce sürekli fonksiyondan baþlýyorduk,
sonra $K$ matrisi üzerinden ayrýksal hale geçiriyorduk. Hoca burada
özdeðer, özvektör formundan baþladý, ve sürekli forma geçti. Sonra üstteki
denklemin çözümünü bulunca, tekrar geri gidecek, ve ayrýksal olarak
özvektörlerin birbirine dikliðini göreceðiz, ve bunun sürekli baðlamda da
hala geçerli olduðunu anlayacaðýz. 

Çözümü bulmak için tahmin yöntemini kullanalým: hangi fonksiyonun ikinci
türevinin negatifi, o fonksiyonun katýný verir? Sin ve cos fonksiyonlarý,
yani $y$ $\sin \omega x$, $\cos \omega x$ olabilir, ya da onlarýn birleþimi
olarak üstel $e^{-i\omega x}$, $e^{i\omega x}$ formunda olabilir.

Eðer $y$ için $\sin, \cos$ kullanýrsak özdeðer ne olur? Yerine koyarsak
görürüz, $\sin\omega x$'in iki kere türevini alýrsak $\omega$ iki kere
dýþarý çýkar, arada bir eksi deðeri mutlaka ortaya çýkar (çünkü 
$\cos'\theta = -\sin\theta)$, eksi ile eksi çarpýlýr, sonuç $\omega^2$. 
Hatta üstteki tüm $y$ seçenekleri için sonuç aynýdýr. 
 
Sýnýr koþullarýný unutmayalým tabii. Problemin tamamý

$$ -\frac{d^2y}{dx^2} = \lambda y(x) $$

$$ y(0) = 0, \ y(1) = 0 $$

Sýnýr koþullarý sayesinde tüm $\sin$, tüm $\cos$ fonksiyonlarý arasýndan belli
bazýlarýný seçebileceðiz. En basit eleme $y(0) = 0$, bu þart sayesinde cos
fonksiyonlarýnýn tamamý elenir. Deðil mi? Çünkü $\cos(0) = 0$ doðru
olamaz. Diðer þarta bakalým, $y(1)$ üzerinden $\sin(\omega) = 0$ olur,
tersinden düþünürsek $\sin(\omega)$ ile sýfýr deðeri verecek $\omega$ ne
olabilir? $\pi$ olabilir. O zaman bir çözüm bulduk:

$$ y_1 = \sin \pi x $$

Elimizdeki ilk ``özfonksiyon (eigenfunction)'' bu. Özdeðeri nedir?

$$ \lambda_1 = \pi^2 $$

çünkü üstte belirttik, $\omega^2$, o zaman $\pi^2$. 

Ýkinci deðer ne olur? $2\pi$. 

$$ y_2 = sin2\pi x, \ \lambda_2 = (2\pi)^2 = 4\pi^2 $$

Eðer sýnýr þartlarýný deðiþtirseydim, serbest / serbest, serbest / sabit
gibi, o zaman farklý $y$ deðerleri elde ederdim. Mesela ilk sýnýr þartý
$y'(0) = 0$ olsaydý, sin fonksiyonlarý yerine cos fonksiyonlarý elde
ederdik, sin elenirdi çünkü sin'in türevi $\cos(0) = 0$ doðru bir ifade
olamazdý. 

Ayrýksal olarak temsil edersek, $\sin\pi h$ ve $h = 1 / n+1$, $n = 4$
kullanalým

$$ 
y_1 = 
\left[\begin{array}{c}
\sin \frac{\pi}{5} \\
\sin \frac{2\pi}{5} \\
\sin \frac{3\pi}{5} \\
\sin \frac{4\pi}{5} 
\end{array}\right]
 $$

\includegraphics[height=2cm]{6_2.png}

Bu da ikinci özvektör (özfonksiyon). 

$$ 
y_2 = 
\left[\begin{array}{c}
sin \frac{2\pi}{5} \\
sin \frac{4\pi}{5} \\
sin \frac{6\pi}{5} \\
sin \frac{8\pi}{5} 
\end{array}\right]
 $$

\includegraphics[height=2cm]{6_3.png}

Özvektörler olduðunu söylemekle ikinci bir þey daha söylüyoruz, bu iki
vektör birbirine dik. Buradan hareketle $\sin(\pi x)$ fonksiyonu (iki
üstteki resim) $\sin(2\pi x)$ fonksiyonuna (bir üstteki resim) dik
diyebilirdik, ki hakikaten öyledir. Hatta bu matematiksel durum Fourier
Serilerinin iþlemesini saðlayan önemli bir etkendir.

Bu baðlantýdan devam edelim: pür vektörler olduðu zaman diklik kontrolü için
$y_1^T \cdot y_2$ diyordum, ve $y_1$ ve $y_2$'nin eþleþen elemanlarý birbiriyle 
çarpýlýp, bu sonuçlar teker teker toplanýyordu. Elimde $y_1$ ve $y_2$ için 
birer fonksiyon var ise, bir tarafta $\sin(\pi x)$ var, her $x$ için deðiþik
deðerler veriyor, diðer tarafta $\sin(2\pi x)$ var, bunlarý çarpýp toplamam
lazým. Ama elimde teker teker toplayabileceðim deðerler olmadýðý için ($x$ reel
bir sayýdýr, belli bir aralýkta bile sonsuz tane deðere sahip olabilir), o
zaman toplama yerine entegrasyon kullanmam lazým. O zaman

$$ y_1^T \cdot y_2  = \int_0^1 (\sin \pi x)(\sin 2\pi x) \ud x  $$ 

Sonuç sýfýr gelecek, çünkü iki fonksiyon birbirine dik.

Soru 1.5.3

\begin{minted}[fontsize=\footnotesize]{python}
import scipy.linalg as lin

def ktbc(n):
    vec = np.zeros((1,n))
    vec[0,0] = 2
    vec[0,1] = -1
    K = lin.toeplitz(vec)
    T = np.copy(K)
    T[0,0] = 1
    B = np.copy(K)
    B[0,0] = 1
    B[n-1,n-1] = 1
    C = np.copy(K)
    C[n-1,n-1] = 1
    
    return K, T, B, C

import scipy.linalg as lin
import ktbc

K,T,B,C =  ktbc.ktbc(5)

u,v=lin.eig(K)

print u

print 2-np.sqrt(3), 2-1, 2-0, 2+1, 2+np.sqrt(3)

print 2*np.ones((5,1)).T - 2*np.cos((np.arange(5)+1) * np.pi/6)
\end{minted}

\begin{verbatim}
[ 3.73205081+0.j  3.00000000+0.j  2.00000000+0.j  0.26794919+0.j
  1.00000000+0.j]
0.267949192431 1 2 3 3.73205080757
[[ 0.26794919  1.          2.          3.          3.73205081]]
\end{verbatim}


\end{document}





