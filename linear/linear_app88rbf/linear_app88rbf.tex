\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Dairesel Baz Fonksiyonlarý (Radial Basýþ Functions -RBF-), Yükseklik Verisi, Daðlar

Ara deðerlemek (interpolation), yani elde olan veriyi kullanýp olmayan hakkýnda
tahmin yapmaya uðraþmak için çok boyutlu ortamda RBF iyi iþleyen bir
yaklaþým. Belki de zihinde en rahat canlandýrýlabilecek örnek yeryüzünde daðlara
ovalara tekabül eden yükseklik (elevation) verilerini alarak onlara sürekli tepe
fonksiyonlarý ``uydurmak'' böylece daðlarýn nerede olduðunu sürekli þekilde
saptamak.

Verisel baðlamda düþük çözünürlükte yükseklik verisi ise yaramayabilir, eðer bir
nokta daðýn bir eteðinde diðeri öteki yanindaki eteðinden alýnmýþsa bu dað yok
anlamýna gelecektir. Peki yükseklik verisinin geldiði yerden daha yüksek
çözünürlüklü veri almýyoruz?  Bu hem eriþim hem de tutacaðý yer baðlamýnda
pahalý olabilir. 1 derecelik enlem / boylam içinde, mesela 36-37 ve 32-33 arasý
diyelim, 100 metrelik çözünürlük demek 0.001 derece deðiþimine tekabül eder, ve
bu durumda 1 milyon veri noktasý alýnmasý gerekecektir. Halbuki yükseklik
verisinden yüzde 3 miktarýnda bile bir rasgele örneklem alýrsak, bu noktalara
RBF ile tepe fonksiyonlarý uydurarak matematiksel, sürekli olan bir genel
fonksiyon elde ederiz, ve uydurma iyi iþlerse artýk istediðimiz çözünürlükte
yükseklik verisi elde edebiliriz çünkü elimizdeki sürekli fonksiyona istediðimiz
her nokta için yükseliðin ne olduðunu artýk hesaplattýrabiliriz.

Bu örneði 3 boyutta herhangi bir baþka veri için de düþünmek mümkün; ama
yükseklik verisinde daha rahat, her örneklem noktasýna konulan tepeler ve
onlarýn birleþimi bize pürüzsüz, sürekli bir engebe þekli verir. RBF baz
fonksiyonlarý $\Phi(x) = f(||x-c||)$ þeklindedir, $f$ tepe, ya da farklý bir
fonksiyon olabilir, $||\cdot||$ norm fonksiyonudur, Öklitsel norm olabilir
mesela.

Burada $c$ üstüne baz fonksiyon konulan nokta, her örneklem veri noktasý
yani. RBF eðitimi / uydurma metadolijisine göre herhangi bir veri noktasý
dýþýndaki tüm diðer örneklem verileri o veri noktasýnýn oluþumunu etkiler. Bu
anormal bir faraziye deðil, bir daðýn baþýnda, ortasýnda, tepesinden alýnmýþ
örneklemler varsa, mesela en alt ve en tepedeki veri ortadakini etkiler, yani o
baðlantýyý, iliþkiyi farzetmek normaldir. Orta nokta zirveyi tanýmlayan
fonksiyona belli bir aðýrlýkla baðlý, en alttakine baþka bir þekilde baðlý,
vs. Bu aðýrlýklarýn ne olacaðýný genel çözüm belirleyecektir. Eðer $f$ için
Gaussianýmsý bir tepe fonksiyonu seçersek, yeni gözlemin baz fonksiyonlarý ile
arasýndaki iliþki,

$$
h(x) = \sum_{n=1}^N w_n \times exp(-\gamma \|x-x_n\|^2)
$$

olarak gösterilebilir. Ýki üstteki formüldeki $x-c$ kullanýmýna dikkat, bu
aslýnda ``diðer noktalarý'' temsil etmenin akýllýca bir yolu, $c$ üzerinde $x-c$
sýfýr deðerdedir, bu o noktayý temsil için diðer noktalar üzerindeki bazlarýn
devreye girmesi gerektiðini modelde zorlamýþ olur.

Her bazýn etkisi $w_n$ aðýrlýðý üzerinden modele yansýtýlýr. Bu aðýrlýklarýn ne
olduðunu bulmak, nihai genel fonksiyonu bulmuþ olmak anlamýna gelir. Farklý
indiþlerle tekrar belirtmek gerekirse her veri noktasý için þu doðru olmalý,

$$
y_n = \sum_{n=1}^N w_m \times exp(-\gamma \|x_n-x_m\|^2)
$$

Bu bize $N$ tane denklem ve $N$ tane bilinmeyen saðlar. Üstteki formülü matris
formunda gösterebiliriz,

$$
\underbrace{
\left[\begin{array}{rrr} \exp(-\gamma \|x_1-x_1\|^2) & \cdots & \exp(-\gamma
    \|x_1-x_N\|^2)\\ \exp(-\gamma \|x_2-x_1\|^2) & \cdots & \exp(-\gamma
    \|x_2-x_N\|^2)\\ \vdots & \ddots & \vdots \\ \exp(-\gamma \|x_N-x_1\|^2) &
    \cdots & \exp(-\gamma \|x_N-x_N\|^2)
\end{array}\right]
}_{\Phi}
\underbrace{
\left[\begin{array}{r}
 w_1  \\
 w_2  \\
 \vdots \\
 w_N
\end{array}\right]}_{w}
=
\underbrace{
\left[\begin{array}{rrr}
 y_1  \\
 y_2  \\
 \vdots \\
 y_N
\end{array}\right]}_{y}
$$

Bu durumda $w = \Phi^{-1}y$ bize $w$ aðýrlýklarýný, yani nihai çözümü
verecektir. 

Bir ornek uzerinde gorelim,

\begin{minted}[fontsize=\footnotesize]{python}
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
from matplotlib import cm
import numpy as np
import matplotlib.pyplot as plt
import numpy.linalg as lin
from scipy.spatial.distance import cdist
\end{minted}

Altta \verb!func! fonksiyonu örneklem üretmek için kullanýlacak, normal
þartlarda bu fonksiyonu bilmiyoruz, sadece ondan gelen örneklem verilerini
biliyoruz. Bir örnek amaçlý, belli bir þekli zorlamak için bunu yaptýk. 

\begin{minted}[fontsize=\footnotesize]{python}
np.random.seed(0)

def func(x, y):
    s1 = 0.2; x1 = 36.5; y1 = 32.5
    g1 = np.exp( -4 *np.log(2) * ((x-x1)**2+(y-y1)**2) / s1**2)
    s2 = 0.4; x2 = 36.1; y2 = 32.8
    g1 = np.exp( -4 *np.log(2) * ((x-x1)**2+(y-y1)**2) / s1**2)
    g2 = np.exp( -2 *np.log(2) * ((x-x2)**2+(y-y2)**2) / s2**2)    
    return g1 + g2 

D = 50
S = 100
gamma = 2.0

x = np.linspace(36,37,D)
y = np.linspace(32,33,D)

xx,yy = np.meshgrid(x,y)
zz = func(xx,yy)

fig = plt.figure()
ax = fig.gca(projection='3d')
surf = ax.plot_surface(xx, yy, zz, cmap=cm.coolwarm,linewidth=0, antialiased=False)
fig.colorbar(surf, shrink=0.5, aspect=5)
plt.savefig('linear_app88rbf_01.png')
\end{minted}

\includegraphics[width=20em]{linear_app88rbf_01.png}

Ýki tane tepe var. Þimdi bu fonksiyondan rasgele örneklem alalým, ve $\Phi$
üzerinden RBF aðýrlýklarýný hesaplayalým,

\begin{minted}[fontsize=\footnotesize]{python}
xxx = xx.reshape(D*D)
yyy = yy.reshape(D*D)
zzz = zz.reshape(D*D)

idx = np.random.choice(range(D*D),S)

xr = xxx[idx].reshape(S,1)
yr = yyy[idx].reshape(S,1)
zr = zzz[idx].reshape(S,1)
X = np.hstack((xr,yr))

Phi = np.exp(-gamma*cdist(X,X,metric='euclid'))

w = np.dot(lin.pinv(Phi),zr)
\end{minted}

Aðýrlýklarla fonksiyonu tekrar yaratmaya uðraþalým,

\begin{minted}[fontsize=\footnotesize]{python}
a = np.vstack((xxx,yyy))
d = cdist(X,a.T)
d = np.exp(-gamma * d)
dd = np.dot(w.T,d)
znew = dd.reshape(D,D)

fig = plt.figure()
ax = fig.gca(projection='3d')
surf = ax.plot_surface(xx, yy, znew, cmap=cm.coolwarm,linewidth=0, antialiased=False)
fig.colorbar(surf, shrink=0.5, aspect=5)
plt.savefig('linear_app88rbf_02.png')
\end{minted}

\includegraphics[width=20em]{linear_app88rbf_02.png}

Orijinale benziyor. 

Kaynaklar

[1] Neto, {\em Radial Basis Functions}, \url{http://www.di.fc.ul.pt/~jpn/r/rbf/rbf.html}

\end{document}






