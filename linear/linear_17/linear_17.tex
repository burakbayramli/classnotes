\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Ders 17

Bugün dikgenlik (orthogonality) ders dizisinin sonuncusundayýz. Dikgen
vektörleri, iki tanesini gördük, dikgen altuzaylarý gördük, ki bunlar satýr
uzayý ve sýfýr uzayý idi, bugün dikgen baz ve dikgen matrisi göreceðiz.

Þimdi birimdik (orthonormal) kelimesinden bahsetmek istiyorum. Bu arada bu
derste $q$ harfini dikgen vektörleri temsil etmek için kullanacaðým.

Birimdik vektörler 

$$
q_i^Tq_j = \left\{ \begin{array}{lll}
0 & \textrm{eðer} & i \ne j \textrm{ ise}\\
1 & \textrm{eðer} & i = j \textrm{ ise}
\end{array} \right.
$$

Yani $q$ vektörleri diðer her $q$'ya (kendisi haricinde) dikgen. Her biri
bir diðerine 90 derece dik vektörlerden oluþan bir baz olmasý doðal bir
þey. $q$ vektörleri birim, bu sebeple kendisiyle noktasal çarpýmý
1. Birimdik kelimesinin Ýngilizcesi orthonormal'ýn içindeki ``normal''
buradan geliyor, normalize edilmiþ vektörlerimiz var.

Birimdik baza sahip olmak hesaplarý basitleþtirir, çoðu hesabý iyileþtirir,
sayýsal lineer cebirin çoðunluðu birimdik vektörlerle iþ yapmak etrafýnda
kurulmuþtur, çünkü onlar aþýrý büyümezler, aþýrý küçülmezler, kontrol
altýnda iþ yapmak mümkün olur.

Bu $q$'leri $Q$ içine koyacaðýz. Dersin ikinci kýsmýnda eðer birimdik
olmayan bir $A$ matrisim var ise, onu nasýl birimdik yaparým, onu
göreceðiz. Þimdi üstteki 1 ve 0 içeren formülü matris olarak yazmak
istiyorum.

$$
Q = 
\left[\begin{array}{rrr}
\uparrow &  & \uparrow \\
q_1 & ... &  q_n \\
\downarrow &  & \downarrow 
\end{array}\right]
$$

O zaman 

$$
Q^TQ = 
\left[\begin{array}{rrr}
\leftarrow & q_1^T & \rightarrow \\
& &  \\
\leftarrow & q_n^T & \rightarrow 
\end{array}\right]
\left[\begin{array}{rrr}
\uparrow &  & \uparrow \\
q_1 & ... &  q_n \\
\downarrow &  & \downarrow 
\end{array}\right] = 
I
$$

Eðer $Q$ kare ise, $Q^TQ = I$  bize $Q^T = Q^{-1}$ olduðunu söyler. 

Örnek 

Her permutasyon matrisi 

$$
Q = 
\left[\begin{array}{rrr}
0 & 0 & 1 \\
1 & 0 & 0 \\
0 & 1 & 0 
\end{array}\right]
$$

kendi devriði ile çarpýlýnca, yani 

$$
Q^T = 
\left[\begin{array}{rrr}
0 & 1 & 0 \\
0 & 0 & 1 \\
1 & 0 & 0 
\end{array}\right]
$$

ile, sonuç $I$ olacaktýr. Bir diðer örnek 

$$Q = 
\left[\begin{array}{cc}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta \\
\end{array}\right]
$$

Fakat þu matris,

$$Q = 
\left[\begin{array}{cc}
1 & 1 \\
1 & -1 \\
\end{array}\right]
$$

dikgen matris deðildir (þimdilik). Her kolonun uzunluðu $\sqrt{2}$, o
zaman tüm matrisi $\sqrt{2}$ ile bölerim,

$$Q = \frac{1}{\sqrt{2}}
\left[\begin{array}{cc}
1 & 1 \\
1 & -1 \\
\end{array}\right]
$$

Örnek 

$$Q = \frac{ 1}{2}
\left[\begin{array}{rrrr}
1 & 1& 1& 1 \\
1 & -1& 1& -1 \\
1 & 1& -1& -1 \\
1 & -1& -1& 1 
\end{array}\right]
$$

Örnek 

$$Q = \frac{ 1}{3}
\left[\begin{array}{rr}
1 & -2 \\
2 & -1 \\
2 & 2 
\end{array}\right]
$$

Bir kolon daha eklersem 

$$Q = \frac{ 1}{3}
\left[\begin{array}{rrr}
1 & -2 & 2\\
2 & -1 & -2 \\
2 & 2 & 1
\end{array}\right]
$$

Birimdik vektörler ve özelde Gram-Schmidt ile uðraþýrken göreceðiz,
sürekli normal vektörlerle uðraþtýðýmýz için sürekli uzunluða bölmeniz
gerekir, ve bu sürekli bir karekökü hesabýn içine çeker. Üstteki örnek
temiz, karekök direk sayý olarak elde edildi. 

Dikgen matrisler niye iyidir? Onlar hangi hesaplarý basitleþtirirler?
$Q$ ne için kullanýlýr? 

Diyelim ki bir diðer matrisi alýp $Q$'nun kolon uzayýna yansýtmak
(projection) istiyorum. Yansýtma formülünü, matrisi $Q$ için yazarsak,

$$P = Q (Q^TQ)^{-1}Q^T$$

Formülde $Q$ olmasýnýn bir avantajý, $Q^TQ = I$, o zaman 

$$P = Q Q^T$$

Bu yansýtma matrisinin özelliklerini / öðelerini (properties) kontrol
edelim. Ýki tane özellik olmasý gerekiyor. Eðer kolonlar birimdik ise, ve
yansýtma matrisi kare ise, o zaman kolon uzayý nedir? Tüm uzaydýr!
Birimdik kolonlar o uzayý yaratmak / kapsamak (span) için
yeterlidir. Bu uzaydaki her türlü vektörü bu birimdik vektörlerin bir
kombinasyonu üzerinen üretebilirsiniz. Peki, tüm uzaya yansýtmak ne
demektir? Nasýl bir $P$ tüm uzaya yansýtýr? Birim (identity) matrisi. Tüm
uzaya yansýtmak hiçbir þeyi deðiþtirmemek demektir aslýnda, ve bu
deðiþmezliði yapacak tek yansýtma matrisi $I$. 

$$P = Q Q^T = I \textit{ eðer I kare ise }$$

Bir diðer özellik yansýtma matrislerinin simetrik olmasý. Devriði ile
saðdan çarpýlmak bir matrisi zaten simetrik yapar, þart $QQ^T$ için
geçerlidir. Bu özelliðin sebebi yansýtýp, sonra tekrar yansýtýnca, ikinci
yansýtmanýn deðiþim yaratmamasý. Yani 

$$(QQ^T)(QQ^T) = QQ^T$$

olmalý. Kontrol edelim,

$$Q(Q^TQ)Q^T = QIQ^T = QQ^T$$

$Q$'nun özellikleri bize þu þekilde de yarar. Normal formül nedir? 

$$A^TA\hat{x} = A^Tb$$

$A$ yerine $Q$ ise

$$Q^TQ\hat{x} = Q^Tb$$

$Q^TQ = I$ olduðuna göre, 

$$\hat{x} = Q^Tb$$

Ýþler iyice basitleþti yani. $A$'li versiyonda sol taraftaki iç çarpýmlarý
(inner product) hesaplamak gerekecekti, cebirsel çözüm için uðraþýlacaktý,
vs. Bunlar $Q$ ile yok. $\hat{x}$'in $i$'inci elemaný $q_i^Tb$, yani 

$$\hat{x}_i = q_i^Tb$$

Üstteki formülün matematiðin en önemli formüllerinden biri olduðu
söylenebilir. Yani elimizde birimdik baz var ise, yansýmasýnýn $i$'inci
öðesi yukarýdaki gibidir. 

Þimdi dersin ikinci bölümüne gelelim. Diyelim ki elimizde birimdik matris
yok, baðýmsýz vektörler var, onlarý birimdik yapacaðýz. Gram-Schmidt
burada ortaya çýkýyor. Tabii ``birimdik yapmak'' nedir, onu da
açýklayalým. Eðer vektör $a,b$ baðýmsýz vektörleri birbirine dik deðilse,
onlarý deðiþime uðratmadan dik hale getiremeyiz. Birimdikleþtirme iþlemi
vektörleri ``eski haline mümkün olduðunca yakýn kalmak suretiyle''
dikleþtirir ve normalleþtirir. 

Gram-Schmidt

GS hesabý eliminasyon ile ayný þey deðildir, amacýmýz üçgensel deðil,
amacýmýz bir matrisi dikgen, kolonlarýný birimdik yapmak. Ýki
vektörümüz var diyelim, $a,b$. Belki 12 boyutlu bir ortamdalar, belki
(alttaki gibi) 2 boyuttalar. Vektörler baðýmsýz. 

\includegraphics[height=3cm]{17_1.png}

Bu iki vektörden $q_1,q_2$ birimdik vektörlerini çýkartmak istiyorum. Ya
da, önce dikgen $A,B$, sonra birimdik $q_1,q_2$ diyelim. Bunun için önce

$$q_1 = \frac{ A}{||A||}, q_2 = \frac{ B}{||B||} $$

Aslýnda $a$'dan $A$ alýnca, o vektörün iþi bitmiþ kabul edilebilir. Bir yön
tamam, ama ilk yön olduðu için onun dikgen hali yeterli. Þimdi ikinci
vektör nasýl birimdik olacak, çünkü artýk birinciye göre dik olmalý, onu
olduðu gibi alamayýz. 

\includegraphics[height=3cm]{17_2.png}

Aradýðýmýz vektör $b$'nin $a$'ya yansýmasý deðil, ona tam dik olan
$e$. Eðer $b$'nin formülü ``$b$'nin $a$'ya yansýmasý, artý $e$'' ise, o
zaman ters yöne gitmek için çýkartma iþlemini kullanýrýz,

$$B = b - [yansýma]$$

$b$'nin $a$'ya yansýmasý nedir? Yerine koyalým,

$$B = b - \frac{ A^Tb}{A^TA}A$$

Bu formül doðru mu? Kontrol edelim, eðer $B$ hakikaten $A$'ya dikgen bir
vektör veriyorsa, o zaman $A^T$ ile çarpýlýnca sýfýr elde etmeliyiz. 

$$A^TB = A^T(b - \frac{ A^Tb}{A^TA}A)$$

$$= A^Tb - \frac{ A^Tb}{A^TA}A^TA$$

$$= A^Tb - A^Tb = 0$$

Peki ya iki deðil üç tane vektör olsaydý? Yani $A,B$'ye ek olarak bir de
$C$ hesaplamamýz gerekiyor. 

\includegraphics[height=3cm]{17_3.png}

Bu hesaba þu þekilde bakabiliriz, aynen $B$'yi bulmak için $b$'den $a$ yönünde
olan yansýmasýnýn kýsmýný çýkarttýðýmýz gibi, $C$'yi bulmak için $c$'den $a$ ve
$b$ yönünde olan yansýmasýnýn kýsýmlarýný çýkartmayý düþünebiliriz.

$$C = c - \frac{ A^Tc}{A^TA}A - \frac{ B^Tc}{B^TB}B$$

Yani $C \perp A$, $C \perp B$. 

Örnek

$$
a = 
\left[\begin{array}{r}
1 \\ 1 \\ 1
\end{array}\right],
b = 
\left[\begin{array}{r}
1 \\ 0 \\ 2
\end{array}\right]
$$

Hemen $A = a$ deriz. $B$ nedir?

$$
B = 
\underbrace{
\left[\begin{array}{r}
1 \\ 0 \\ 2
\end{array}\right]}_{b}
-
\frac{ 3}{3}
\underbrace{
\left[\begin{array}{r}
1 \\ 1 \\ 1
\end{array}\right]}_{A}
=
\left[\begin{array}{r}
0 \\ -1 \\ 1
\end{array}\right]
$$

$Q$'yu oluþturalým. Unutmayalým, her $q$ birim vektör, normalize
olmalý. Problem deðil, deðerleri üstten alýrken her elemaný uzunluðuna
böleriz, 

$$Q =
\left[\begin{array}{rrr}
\uparrow &  & \uparrow \\
q_1 & ... &  q_n \\
\downarrow &  & \downarrow 
\end{array}\right]
=
\left[\begin{array}{rr}
1/\sqrt{3} & 0 \\
1/\sqrt{3} & -1/\sqrt{2} \\
1/\sqrt{3} & 1/\sqrt{2} 
\end{array}\right]
$$

Hatýrlarsak ilk halimiz

$$A =
\left[\begin{array}{rr}
1 & 1 \\
1 & 0\\
1 & 2
\end{array}\right]
$$

þeklindeydi. 

$Q$'nun kolon uzayý ile $A$'nin kolon uzayý arasýndaki baðlantý, fark
nedir? Kolon uzayý bir matrisin kolonlarýnýn tüm kombinasyonlarý ise, 3
boyutlu uzayda iki kolonum var, demek ki kolon uzayý bir düzlem (plane),
her iki matris için durum bu. Alaka nerede? Ýki düzlem de ayný! Tek
yaptýðým ayný uzayý yaratan ama birbirine dik iki yeni vektör yaratmak
oldu. $Q$ vektörlerinden daha memnunum çünkü $Q$ birimdik. 

Peki Gram-Schmidt'i Lineer Cebir dilinde nasýl daha temiz sekilde
gösteririm? Eliminasyon mesela 

$$A = LU$$

olarak gösterilir. Gram-Schmidt'in karþýlýðý nedir? Þudur,

$$A = QR$$


$$
\left[\begin{array}{rrr}
\uparrow &  \uparrow \\
a_1 &  a_2 \\
\downarrow &  \downarrow 
\end{array}\right]
=
\left[\begin{array}{rrr}
\uparrow &  \uparrow \\
q_1 &  q_2 \\
\downarrow &  \downarrow 
\end{array}\right]
\left[\begin{array}{rrr}
 &   \\
0 &  
\end{array}\right]
$$

Yani $R$ üst üçgensel (lower triangular) bir matristir, sol alt köþe
sýfýrdýr. Niye? 

$$
= \left[
\begin{array}{rrr}
\uparrow &  \uparrow \\
q_1 &  q_2 \\
\downarrow &  \downarrow 
\end{array}\right]
\left[\begin{array}{rrr}
a_1^Tq_1 &  * \\
a_1^Tq_2 &  *
\end{array}
\right]
$$

Sýfýr $a_1^Tq_1$'dan geliyor. Özetlemek gerekirse, $A$'yi alýp $Q$'yu elde
ediyoruz, ve bu iki matris arasýndaki iliþki üst üçgensel olan $R$
matrisi. 

Gram-Schmidt Python kodu altta bulunabilir.

\begin{minted}[fontsize=\footnotesize]{python}
import numpy.linalg as lin

A = np.array([[3., 4.],[5., 6.]])
m,n = A.shape
R = np.zeros((m,n))
Q = np.zeros((m,n))

for j in range(n):
    v = A[:,j]
    for i in range(j):
        R[i,j] = np.dot(Q[:,i].T,A[:,j])
        v=v-np.dot(R[i,j],Q[:,i])
    R[j,j] = lin.norm(v)
    Q[:,j] = v/R[j,j]
print Q, R
\end{minted}

\begin{verbatim}
[[ 0.51449576  0.85749293]
 [ 0.85749293 -0.51449576]] [[ 5.83095189  7.20294058]
 [ 0.          0.34299717]]
\end{verbatim}


\end{document}
